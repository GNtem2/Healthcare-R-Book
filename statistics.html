<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Statistics – Healthcare-R-Book</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./multivariate.html" rel="next">
<link href="./data-wrangling-python.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>

<script src="site_libs/viz-1.8.2/viz.js"></script>

<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">

<script src="site_libs/grViz-binding-1.0.10/grViz.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Healthcare-R-Book</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling-images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Medical Images</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling-signal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Signal processing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Machine learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graph-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Graph Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./natural-language-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Natural language processing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Bayesian Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./operational-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Operational Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geospatial-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Geospatial analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#univariable-analyses" id="toc-univariable-analyses" class="nav-link active" data-scroll-target="#univariable-analyses"><span class="header-section-number">6.1</span> Univariable analyses</a>
  <ul class="collapse">
  <li><a href="#parametric-tests" id="toc-parametric-tests" class="nav-link" data-scroll-target="#parametric-tests"><span class="header-section-number">6.1.1</span> Parametric tests</a></li>
  <li><a href="#non-parametric-tests" id="toc-non-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests"><span class="header-section-number">6.1.2</span> Non-parametric tests</a></li>
  </ul></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression"><span class="header-section-number">6.2</span> Regression</a>
  <ul class="collapse">
  <li><a href="#brief-review-of-matrix" id="toc-brief-review-of-matrix" class="nav-link" data-scroll-target="#brief-review-of-matrix"><span class="header-section-number">6.2.1</span> Brief review of matrix</a></li>
  <li><a href="#linear-least-square-regression" id="toc-linear-least-square-regression" class="nav-link" data-scroll-target="#linear-least-square-regression"><span class="header-section-number">6.2.2</span> Linear (least square) regression</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="header-section-number">6.2.3</span> Logistic regression</a></li>
  <li><a href="#discrimination-and-calibration" id="toc-discrimination-and-calibration" class="nav-link" data-scroll-target="#discrimination-and-calibration"><span class="header-section-number">6.2.4</span> Discrimination and Calibration</a></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction"><span class="header-section-number">6.2.5</span> Interaction</a></li>
  </ul></li>
  <li><a href="#confounder" id="toc-confounder" class="nav-link" data-scroll-target="#confounder"><span class="header-section-number">6.3</span> Confounder</a>
  <ul class="collapse">
  <li><a href="#confounder-weighted-model" id="toc-confounder-weighted-model" class="nav-link" data-scroll-target="#confounder-weighted-model"><span class="header-section-number">6.3.1</span> Confounder weighted model</a></li>
  <li><a href="#propensity-matching" id="toc-propensity-matching" class="nav-link" data-scroll-target="#propensity-matching"><span class="header-section-number">6.3.2</span> Propensity matching</a></li>
  <li><a href="#e-values" id="toc-e-values" class="nav-link" data-scroll-target="#e-values"><span class="header-section-number">6.3.3</span> E-values</a></li>
  </ul></li>
  <li><a href="#causal-inference" id="toc-causal-inference" class="nav-link" data-scroll-target="#causal-inference"><span class="header-section-number">6.4</span> Causal inference</a></li>
  <li><a href="#special-types-of-regression" id="toc-special-types-of-regression" class="nav-link" data-scroll-target="#special-types-of-regression"><span class="header-section-number">6.5</span> Special types of regression</a>
  <ul class="collapse">
  <li><a href="#ordinal-regression" id="toc-ordinal-regression" class="nav-link" data-scroll-target="#ordinal-regression"><span class="header-section-number">6.5.1</span> Ordinal regression</a></li>
  <li><a href="#survival-analysis" id="toc-survival-analysis" class="nav-link" data-scroll-target="#survival-analysis"><span class="header-section-number">6.5.2</span> Survival analysis</a></li>
  <li><a href="#quantile-regression" id="toc-quantile-regression" class="nav-link" data-scroll-target="#quantile-regression"><span class="header-section-number">6.5.3</span> Quantile regression</a></li>
  <li><a href="#non-negative-regression" id="toc-non-negative-regression" class="nav-link" data-scroll-target="#non-negative-regression"><span class="header-section-number">6.5.4</span> Non-negative regression</a></li>
  <li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression"><span class="header-section-number">6.5.5</span> Poisson regression</a></li>
  <li><a href="#conditional-logistic-regression" id="toc-conditional-logistic-regression" class="nav-link" data-scroll-target="#conditional-logistic-regression"><span class="header-section-number">6.5.6</span> Conditional logistic regression</a></li>
  <li><a href="#multinomial-modelling" id="toc-multinomial-modelling" class="nav-link" data-scroll-target="#multinomial-modelling"><span class="header-section-number">6.5.7</span> Multinomial modelling</a></li>
  </ul></li>
  <li><a href="#sample-size-estimation" id="toc-sample-size-estimation" class="nav-link" data-scroll-target="#sample-size-estimation"><span class="header-section-number">6.6</span> Sample size estimation</a>
  <ul class="collapse">
  <li><a href="#proportion" id="toc-proportion" class="nav-link" data-scroll-target="#proportion"><span class="header-section-number">6.6.1</span> Proportion</a></li>
  <li><a href="#logistic-regression-1" id="toc-logistic-regression-1" class="nav-link" data-scroll-target="#logistic-regression-1"><span class="header-section-number">6.6.2</span> Logistic regression</a></li>
  <li><a href="#survival-studies" id="toc-survival-studies" class="nav-link" data-scroll-target="#survival-studies"><span class="header-section-number">6.6.3</span> Survival studies</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression"><span class="header-section-number">6.6.4</span> Multiple regression</a></li>
  </ul></li>
  <li><a href="#randomised-clinical-trials" id="toc-randomised-clinical-trials" class="nav-link" data-scroll-target="#randomised-clinical-trials"><span class="header-section-number">6.7</span> Randomised clinical trials</a>
  <ul class="collapse">
  <li><a href="#covariate-adjustment-in-trials" id="toc-covariate-adjustment-in-trials" class="nav-link" data-scroll-target="#covariate-adjustment-in-trials"><span class="header-section-number">6.7.1</span> Covariate adjustment in trials</a></li>
  <li><a href="#subgroup-analysis" id="toc-subgroup-analysis" class="nav-link" data-scroll-target="#subgroup-analysis"><span class="header-section-number">6.7.2</span> Subgroup analysis</a></li>
  <li><a href="#p-value-for-interaction" id="toc-p-value-for-interaction" class="nav-link" data-scroll-target="#p-value-for-interaction"><span class="header-section-number">6.7.3</span> p value for interaction</a></li>
  <li><a href="#interpreting-risk-reduction-in-clinical-trials" id="toc-interpreting-risk-reduction-in-clinical-trials" class="nav-link" data-scroll-target="#interpreting-risk-reduction-in-clinical-trials"><span class="header-section-number">6.7.4</span> Interpreting risk reduction in clinical trials</a></li>
  <li><a href="#nnt-from-arr" id="toc-nnt-from-arr" class="nav-link" data-scroll-target="#nnt-from-arr"><span class="header-section-number">6.7.5</span> NNT from ARR</a></li>
  <li><a href="#nnt-from-odds-ratio" id="toc-nnt-from-odds-ratio" class="nav-link" data-scroll-target="#nnt-from-odds-ratio"><span class="header-section-number">6.7.6</span> NNT from odds ratio</a></li>
  <li><a href="#nnt-from-risk-ratio" id="toc-nnt-from-risk-ratio" class="nav-link" data-scroll-target="#nnt-from-risk-ratio"><span class="header-section-number">6.7.7</span> NNT from risk ratio</a></li>
  <li><a href="#nnt-from-hazard-ratio" id="toc-nnt-from-hazard-ratio" class="nav-link" data-scroll-target="#nnt-from-hazard-ratio"><span class="header-section-number">6.7.8</span> NNT from hazard ratio</a></li>
  <li><a href="#nnt-from-metaananlysis" id="toc-nnt-from-metaananlysis" class="nav-link" data-scroll-target="#nnt-from-metaananlysis"><span class="header-section-number">6.7.9</span> NNT from metaananlysis</a></li>
  </ul></li>
  <li><a href="#diagnostic-test" id="toc-diagnostic-test" class="nav-link" data-scroll-target="#diagnostic-test"><span class="header-section-number">6.8</span> Diagnostic test</a>
  <ul class="collapse">
  <li><a href="#sensitivity-specificity" id="toc-sensitivity-specificity" class="nav-link" data-scroll-target="#sensitivity-specificity"><span class="header-section-number">6.8.1</span> Sensitivity, specificity</a></li>
  <li><a href="#auc" id="toc-auc" class="nav-link" data-scroll-target="#auc"><span class="header-section-number">6.8.2</span> AUC</a></li>
  <li><a href="#likelihood-ratio" id="toc-likelihood-ratio" class="nav-link" data-scroll-target="#likelihood-ratio"><span class="header-section-number">6.8.3</span> Likelihood ratio</a></li>
  </ul></li>
  <li><a href="#metaanalysis" id="toc-metaanalysis" class="nav-link" data-scroll-target="#metaanalysis"><span class="header-section-number">6.9</span> Metaanalysis</a>
  <ul class="collapse">
  <li><a href="#quality-of-study" id="toc-quality-of-study" class="nav-link" data-scroll-target="#quality-of-study"><span class="header-section-number">6.9.1</span> Quality of study</a></li>
  <li><a href="#prisma" id="toc-prisma" class="nav-link" data-scroll-target="#prisma"><span class="header-section-number">6.9.2</span> PRISMA</a></li>
  <li><a href="#conversion-of-median-to-mean" id="toc-conversion-of-median-to-mean" class="nav-link" data-scroll-target="#conversion-of-median-to-mean"><span class="header-section-number">6.9.3</span> Conversion of median to mean</a></li>
  <li><a href="#inconsistency-i2" id="toc-inconsistency-i2" class="nav-link" data-scroll-target="#inconsistency-i2"><span class="header-section-number">6.9.4</span> Inconsistency I2</a></li>
  <li><a href="#metaanalysis-of-proportion" id="toc-metaanalysis-of-proportion" class="nav-link" data-scroll-target="#metaanalysis-of-proportion"><span class="header-section-number">6.9.5</span> Metaanalysis of proportion</a></li>
  <li><a href="#metaanalysis-of-continuous-data" id="toc-metaanalysis-of-continuous-data" class="nav-link" data-scroll-target="#metaanalysis-of-continuous-data"><span class="header-section-number">6.9.6</span> Metaanalysis of continuous data</a></li>
  <li><a href="#bivariate-metaanalysis" id="toc-bivariate-metaanalysis" class="nav-link" data-scroll-target="#bivariate-metaanalysis"><span class="header-section-number">6.9.7</span> Bivariate Metaanalysis</a></li>
  <li><a href="#metaanalysis-of-clinical-trial." id="toc-metaanalysis-of-clinical-trial." class="nav-link" data-scroll-target="#metaanalysis-of-clinical-trial."><span class="header-section-number">6.9.8</span> Metaanalysis of clinical trial.</a></li>
  <li><a href="#metaregression" id="toc-metaregression" class="nav-link" data-scroll-target="#metaregression"><span class="header-section-number">6.9.9</span> Metaregression</a></li>
  </ul></li>
  <li><a href="#data-simulation" id="toc-data-simulation" class="nav-link" data-scroll-target="#data-simulation"><span class="header-section-number">6.10</span> Data simulation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This section is not intended as a textbook on statistics. Rather it demonstrates regression approaches that can be used including sample size estimation, R codes provided.</p>
<section id="univariable-analyses" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="univariable-analyses"><span class="header-section-number">6.1</span> Univariable analyses</h2>
<section id="parametric-tests" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="parametric-tests"><span class="header-section-number">6.1.1</span> Parametric tests</h3>
<p>T-test is the workhorse for comparing if 2 datasets are have the same distribution. Performing t-test in R requires data from 2 columns: one containing the variables for comparison and one to label the group. There are different forms of t-test depending on whether the two samples are paired or unpaired. In general, the analysis takes the form of <span class="math inline">\(t=\frac{\mu_1 - \mu_2}{variance}\)</span>. It is recommended to check the distribution of the data by using histogram. For this exercise, we will use the simulated data from ECR trials. The grouping variable is the trial assignment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#comparison of early neurological recovery (ENI) by tral (T)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>dtTrial<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"./Data-Use/dtTrial_simulated.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dtTrial<span class="sc">$</span>ENI<span class="sc">~</span>dtTrial<span class="sc">$</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  dtTrial$ENI by dtTrial$T
t = 0.17454, df = 487.36, p-value = 0.8615
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.04569535  0.05460540
sample estimates:
mean in group 0 mean in group 1 
      0.3084644       0.3040094 </code></pre>
</div>
</div>
</section>
<section id="non-parametric-tests" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="non-parametric-tests"><span class="header-section-number">6.1.2</span> Non-parametric tests</h3>
<p>Chi-squared and Fisher-exact tests can be done by using the <em>table</em> function for setting up the count data into 2 x 2 contingency table or confusion matrix. The formula for the Chi-squared test takes on a familiar form <span class="math inline">\(\chi^2=\frac{(observed-expected)^2}{expected}\)</span>. In this example we will use the data above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      0   1
  0 112 101
  1 144 143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  dtTrial$HT and dtTrial$T
X-squared = 0.19553, df = 1, p-value = 0.6584</code></pre>
</div>
</div>
<p>The Wilcoxon rank sum test is performed with continuous data organised in the same way as the t-test. There are several different approaches to performing Wilcoxon rank sum test. The <em>coin</em> package allows handling of ties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(ENI<span class="sc">~</span>T, <span class="at">data=</span>dtTrial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  ENI by T
W = 31159, p-value = 0.9642
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
</section>
<section id="regression" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="regression"><span class="header-section-number">6.2</span> Regression</h2>
<p>There are many different form of regression methods. A key principle is that the predictors are independent of each others. This issue will be expand on in the later in the section on collinearity. Special methods are required when the predictors are collinear.</p>
<section id="brief-review-of-matrix" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="brief-review-of-matrix"><span class="header-section-number">6.2.1</span> Brief review of matrix</h3>
<p>A vector is has length one. A matrix is an ordered array in 2 dimensions. A tensor is an ordered array in 3 dimensions.</p>
<p>A matrix in which the columns are linearly related are said to be rank deficient. The rank of a given matrix is an expression of the number of linearly independent columns of that matrix. Given that row rank and column rank are equivalent, rank deficiency of a matrix is expressed as the difference between the lesser of the number of rows and columns, and the rank of the matrix. A matrix with rank of 1 is likely to be linearly related.</p>
</section>
<section id="linear-least-square-regression" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="linear-least-square-regression"><span class="header-section-number">6.2.2</span> Linear (least square) regression</h3>
<p>Least square regression uses the geometric properties of Euclidean geometry to identify the line of best. The sum of squares <span class="math inline">\(SSE\)</span> is <span class="math inline">\(\sum(observed-expected)^2\)</span>. The <span class="math inline">\(R^2\)</span> is a measure of the fit of the model. It is given by <span class="math inline">\(1-\frac{SS_(res)}{SS_(total)}\)</span>. Low <span class="math inline">\(R^2\)</span> indicates a poorly fitted model and high <span class="math inline">\(R^2\)</span> indicates excellent fitting. The assumption here is that the outcome variable is a continuous variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"./Data-Use/world_stroke.Rda"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf, <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">Group=</span>Income, <span class="at">linetype=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Life Expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logistic-regression" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">6.2.3</span> Logistic regression</h3>
<p>For outcome that are binary in nature such as yes or no, then least square regression is not appropriate. There are no close form solution for this analysis and a numerical approach using maximum likelihood approach is needed. When examining the results of logistic regression one is often enchanted by the large odds ratio. It is important to look at the metrics of model calibration (discussed below). A clue to a poorly calibrated model is the observation that the width of the confidence interval for odds ratio is wide.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#glm</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"BreastCancer"</span>,<span class="at">package =</span> <span class="st">"mlbench"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#remove id column and column with NA to feed into iml later</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>DCa<span class="ot">&lt;-</span><span class="fu">glm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DCa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Class ~ ., data = BreastCancer2)

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     0.723054   0.018613  38.847  &lt; 2e-16 ***
Cl.thickness    0.042754   0.003992  10.709  &lt; 2e-16 ***
Cell.size       0.019263   0.007293   2.641  0.00845 ** 
Cell.shape      0.032217   0.007016   4.592 5.22e-06 ***
Marg.adhesion   0.021463   0.004386   4.893 1.24e-06 ***
Epith.c.size    0.011637   0.005965   1.951  0.05148 .  
Bl.cromatin     0.035266   0.005650   6.241 7.57e-10 ***
Normal.nucleoli 0.016928   0.004247   3.986 7.44e-05 ***
Mitoses         0.001086   0.006048   0.180  0.85757    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.0481263)

    Null deviance: 157.908  on 698  degrees of freedom
Residual deviance:  33.207  on 690  degrees of freedom
AIC: -126.1

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
</section>
<section id="discrimination-and-calibration" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="discrimination-and-calibration"><span class="header-section-number">6.2.4</span> Discrimination and Calibration</h3>
<p>A high _<span class="math inline">\(R^2\)</span> suggests that the linear regression model is well calibrated. This metric is often not displayed but should be sought when interpreting the data.</p>
<p>The areas under the receiver operating characteristic curve (AUC) is used to assess how well the models discriminate between those who have the disease and those who do not have the disease of interest. An AUC of 0.5 is classified as no better than by chance; 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination. This rule of thumb about interpreting AUC when reading the literature is language the authors used to describe the AUC. This test of discrimination is not synonymous with calibration. It is possible to have a model with high discrimination but poor calibration <span class="citation" data-cites="pmid1738016">(<a href="references.html#ref-pmid1738016" role="doc-biblioref">Diamond 1992</a>)</span>. The AUC is similar to Harrell’s c-index but the interpretation of difference in AUC and c-index between models is not straightforward. A difference in 0.1 of AUC correspond to the number of subject rank correctly. The c-index was originally described for survival analysis <span class="citation" data-cites="pmid7069920">(<a href="references.html#ref-pmid7069920" role="doc-biblioref">Harrell FE Jr 1982</a>)</span>. Harrell described the c-index (concordance index) as estimating the probability that, of two randomly chosen patients, the patient with the higher prognostic score will outlive the patient with the lower prognostic score. As such the c-index should be interpreted as the number of concordant pairs relative to the total number of comparable pairs. It has been proposed that the AUC and c-index is not appropriate for survival analysis as they do not account for the dynamic nature of the data<span class="citation" data-cites="LONGATO2020103496">(<a href="references.html#ref-LONGATO2020103496" role="doc-biblioref">Longato, Vettoretti, and Di Camillo 2020</a>)</span>. The integrated Graf score has been proposed to account for difference in the estimated event-free survival probabilities with the actual outcome <span class="citation" data-cites="pmid10474158">(<a href="references.html#ref-pmid10474158" role="doc-biblioref">Graf E 1999</a>)</span>.</p>
<p>Calibration of logistic regression model is performed using the Hosmer–Lemeshow goodness-of-ﬁt test and the Nagelkerke generalized R2. A model is well calibrated when the Hosmer–Lemeshow goodness-of-ﬁt test shows no difference between observed and expected outcome or P value approaching 1. A high generalized <span class="math inline">\(R^2\)</span> value suggests a well-calibrated regression model. Running regression through the <em>rms</em> or <em>PredictABEL</em> library provide these results. The generalized <span class="math inline">\(R^2\)</span> can be obtained manually from base R by running an intercept only model and again with covariates. It is given by <span class="math inline">\(1-\frac{L1}{L0}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lrm on logistic regression analysis for Breast Cancer</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Hmisc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Hmisc'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    format.pval, units</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>DCa_rms<span class="ot">&lt;-</span><span class="fu">lrm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>DCa_rms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = Class ~ ., data = BreastCancer2)

                       Model Likelihood      Discrimination    Rank Discrim.    
                             Ratio Test             Indexes          Indexes    
Obs           699    LR chi2     759.86      R2       0.915    C       0.993    
 1            458    d.f.             8      R2(8,699)0.659    Dxy     0.986    
 2            241    Pr(&gt; chi2) &lt;0.0001    R2(8,473.7)0.795    gamma   0.986    
max |deriv| 8e-10                            Brier    0.028    tau-a   0.446    

                Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept       -9.9477 1.0317 -9.64  &lt;0.0001 
Cl.thickness     0.5776 0.1190  4.85  &lt;0.0001 
Cell.size       -0.0115 0.1759 -0.07  0.9479  
Cell.shape       0.5679 0.1913  2.97  0.0030  
Marg.adhesion    0.3137 0.1004  3.13  0.0018  
Epith.c.size     0.1306 0.1406  0.93  0.3529  
Bl.cromatin      0.5800 0.1456  3.98  &lt;0.0001 
Normal.nucleoli  0.1232 0.0987  1.25  0.2120  
Mitoses          0.6092 0.3226  1.89  0.0590  </code></pre>
</div>
</div>
<section id="measuring-improvement-in-regression-models" class="level4" data-number="6.2.4.1">
<h4 data-number="6.2.4.1" class="anchored" data-anchor-id="measuring-improvement-in-regression-models"><span class="header-section-number">6.2.4.1</span> Measuring Improvement in Regression Models</h4>
<p>The net reclassification improvement (NRI) and integrated discrimination improvement (IDI) have been proposed as more sensitive metrics of improvement in model discrimination.The NRI can be considered as a percentage reclassiﬁcation for the risk categories and the IDI is the mean difference in predicted probabilities between 2 models (constructed from cases with disease and without disease). The NRI and IDI scores are expressed as fractions and can be converted to percentage by multiplying 100.The continuous NRI and IDI can be performed using <em>PredictABEL</em> [<span class="citation" data-cites="pmid28579970">Phan et al. (<a href="references.html#ref-pmid28579970" role="doc-biblioref">2017</a>)</span>]<span class="citation" data-cites="pmid26796056">(<a href="references.html#ref-pmid26796056" role="doc-biblioref">Phan et al. 2016</a>)</span>.</p>
</section>
<section id="shapley-value" class="level4" data-number="6.2.4.2">
<h4 data-number="6.2.4.2" class="anchored" data-anchor-id="shapley-value"><span class="header-section-number">6.2.4.2</span> Shapley value</h4>
<p>We can use ideas from game theory relating to fair distribution of proﬁt in coalition games; the coalition (co-operative) game in this case can be interpreted as contribution of the covariates to the model. The Shapley value regression method calculates the marginal contribution of each covariate as the average of all permutations of the coalition of the covariates containing the covariate of interest minus the coalition without the covariate of interest. The advantage of this approach is that it can handle multicollinearity (relatedness) among the covariates.</p>
<p>The feature importance is used to assess the impact of the features on the model’s decision</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this section takes the output from logistic regression above.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iml)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> BreastCancer2[<span class="fu">which</span>(<span class="fu">names</span>(BreastCancer2) <span class="sc">!=</span> <span class="st">"Class"</span>)]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>predictor <span class="ot">=</span> Predictor<span class="sc">$</span><span class="fu">new</span>(DCa, <span class="at">data =</span> X, <span class="at">y =</span> BreastCancer2<span class="sc">$</span>Class)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">=</span> FeatureImp<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">loss =</span> <span class="st">"mae"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the logistic regression above cell thickness and cromatin have the highest coefficient and lowest p value. This is the same as feature importance. By contrast the Shapley values show that cell shape and marg adhesion make the largest impact on the model when considering the contribution to the model after considering all the contribution by different coalitions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#explain with game theory</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>shapley <span class="ot">&lt;-</span> Shapley<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">x.interest =</span> X[<span class="dv">1</span>, ])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>shapley<span class="sc">$</span><span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-5-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ice" class="level4" data-number="6.2.4.3">
<h4 data-number="6.2.4.3" class="anchored" data-anchor-id="ice"><span class="header-section-number">6.2.4.3</span> ICE</h4>
<p>The individual conditional expectation (ICE) curves is the plot of the expectation fof the predictive value for each observation at the unique value for the feature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#feature is the covariate of interest</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>eff_thick <span class="ot">&lt;-</span> FeatureEffect<span class="sc">$</span><span class="fu">new</span>(predictor, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">feature =</span> <span class="st">"Cl.thickness"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"ice"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">center.at =</span> <span class="dv">0</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(eff_thick)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-5-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="interaction" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="interaction"><span class="header-section-number">6.2.5</span> Interaction</h3>
<p>Interactions is plotted here using lollipop bar. The <em>ggalt</em> library can be used to create this type of plot with <em>geom_lollipop</em>. The strength of interaction is measured using Friedman’s H-statistics. The H-statistics ranges from 0 to 1 with 1 indicating the overall interaction strength. In the case with Breast Cancer data, the interaction strength is low.</p>
<p>When describing interaction terms it is recommended that the results be expressed as β coefficients rather than as odds ratio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot interactions</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>interact <span class="ot">&lt;-</span> Interaction<span class="sc">$</span><span class="fu">new</span>(predictor)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(interact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-5-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="confounder" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="confounder"><span class="header-section-number">6.3</span> Confounder</h2>
<p>A confounder is a covariate that serves as a cause of both exposure and outcome and as such confound the analysis. A mediator exist on the causal pathway from exposure to outcome. A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment <span class="citation" data-cites="pmid15345796">(<a href="references.html#ref-pmid15345796" role="doc-biblioref">Ingall et al. 2004</a>)</span>.</p>
<p>There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<section id="confounder-weighted-model" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="confounder-weighted-model"><span class="header-section-number">6.3.1</span> Confounder weighted model</h3>
<p>The issue asked is whether one should choose to perform confounder analysis or propensity matching.</p>
</section>
<section id="propensity-matching" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="propensity-matching"><span class="header-section-number">6.3.2</span> Propensity matching</h3>
<p>Propensity matching is an important technique to adjust for imbalance in covariates between 2 arms. There are concerns with mis-use of this technique such as difference in placebo arms from multiple sclerosis trials <span class="citation" data-cites="doi10.1001/jamaneurol.2020.0678">(<a href="references.html#ref-doi10.1001/jamaneurol.2020.0678" role="doc-biblioref">Signori et al. 2020</a>)</span>. It is proposed that this technique should be used only if all the confounders are measurable. This situation may not be satisfied if the data were accrued at different period, in different continent etc.</p>
</section>
<section id="e-values" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="e-values"><span class="header-section-number">6.3.3</span> E-values</h3>
<p>The E-values <span class="citation" data-cites="pmid28693043">(<a href="references.html#ref-pmid28693043" role="doc-biblioref">VanderWeele TJ 2017</a>)</span> has been proposed a measure of unmeasured confounders in observational studies. The E-value is a measure of the extent to which the confounder have on the treatment–outcome association, conditional on the measured covariates. A large E-value is desirable. The E-values is available in <em>Evalue</em> library <span class="citation" data-cites="pmid29912013">(<a href="references.html#ref-pmid29912013" role="doc-biblioref">Mathur MB 2018</a>)</span>.</p>
</section>
</section>
<section id="causal-inference" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">6.4</span> Causal inference</h2>
<p>Causation and association are often miscontrued to be the same. However, the finding of correlation (association) does necessarily imply causation. Causal inference evaluates the response of an effect variable in the setting of change in the cause of the effect variable. There are issues with approach to analysis of causal inference. It can be performed using frequentist such as confounder weighted model or Bayesian methods such as [(Baysian additive regression tree)][Bayesian trees method].</p>
</section>
<section id="special-types-of-regression" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="special-types-of-regression"><span class="header-section-number">6.5</span> Special types of regression</h2>
<section id="ordinal-regression" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="ordinal-regression"><span class="header-section-number">6.5.1</span> Ordinal regression</h3>
<p>Ordinal regression is appropriate when the outcome variable is in the form of ordered categorical values. For example, the Rankin scale of disability is bounded between the values of 0 and 6. This type of analysis uses the proportional odds model and the requirement for this model is stringent. When examining results of ordinal regression check that the authors provide this metric, the Brant test. The Brant test assesses the parallel regression assumption. Ordinal regression is performed using <em>polr</em> function in <em>MASS</em> library. The Brant test is available in the <em>Brant</em> library.</p>
</section>
<section id="survival-analysis" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="survival-analysis"><span class="header-section-number">6.5.2</span> Survival analysis</h3>
<p>Survival analysis is useful when dealing with time to event data. Time to event data can be left, interval and right censoring. Left censoring exists when events may have already occurred at the start of the study eg purchase of phones. Right censoring exists when events have not happened yet eg cancer trial. Interval censoring exists when an insurance has been purchased but the date of product purchase is not yet known.</p>
<p>The Cox model assesses the hazard of outcome between two groups. The assumption of this model is that the hazard between each arm is proportional <span class="citation" data-cites="pmid32167523">(<a href="references.html#ref-pmid32167523" role="doc-biblioref">Stensrud and Hernan 2020</a>)</span>. The proportional hazard model can be tested based on the weighted Schoenfeld residuals<span class="citation" data-cites="10.1093/biomet/81.3.515">(<a href="references.html#ref-10.1093/biomet/81.3.515" role="doc-biblioref">Grambsch and Therneau 1994</a>)</span>. There are non-parametric models available when the assumption of the proportional hazard model does not hold.</p>
<p>In the next chapter on machine learning, an illustration of [random survival forest with <em>rfrsc</em> library][Random survival forest with rfsrc] and <em>ranger</em> library are provided. In the section on [clinical trial][Interpreting clinical trials] we illustrate how the results can be converted to numbers needed to treat. The median survival corresponding to survival probability of 0.50 can be determined here. Metrics for assessing survival model was described <a href="#discrimination-and-calibration">above</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survminer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">"survival"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#time in is available in days</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = cancer)

       n events median 0.95LCL 0.95UCL
[1,] 228    165    310     285     363</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sfit<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> age<span class="sc">+</span>sex<span class="sc">+</span>ph.ecog<span class="sc">+</span>ph.karno<span class="sc">+</span>wt.loss, <span class="at">data =</span> cancer)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, status) ~ age + sex + ph.ecog + ph.karno + 
    wt.loss, data = cancer)

  n= 213, number of events= 151 
   (15 observations deleted due to missingness)

              coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
age       0.015157  1.015273  0.009763  1.553 0.120538    
sex      -0.631422  0.531835  0.177134 -3.565 0.000364 ***
ph.ecog   0.740204  2.096364  0.191332  3.869 0.000109 ***
ph.karno  0.015251  1.015368  0.009797  1.557 0.119553    
wt.loss  -0.009298  0.990745  0.006699 -1.388 0.165168    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

         exp(coef) exp(-coef) lower .95 upper .95
age         1.0153     0.9850    0.9960    1.0349
sex         0.5318     1.8803    0.3758    0.7526
ph.ecog     2.0964     0.4770    1.4408    3.0502
ph.karno    1.0154     0.9849    0.9961    1.0351
wt.loss     0.9907     1.0093    0.9778    1.0038

Concordance= 0.64  (se = 0.026 )
Likelihood ratio test= 33.53  on 5 df,   p=3e-06
Wald test            = 32.27  on 5 df,   p=5e-06
Score (logrank) test = 32.83  on 5 df,   p=4e-06</code></pre>
</div>
</div>
<p>Test proportional hazard assumption using weighted residuals <span class="citation" data-cites="10.1093/biomet/81.3.515">(<a href="references.html#ref-10.1093/biomet/81.3.515" role="doc-biblioref">Grambsch and Therneau 1994</a>)</span>. The finding below shows that inclusion of covariate ph.karno violate proportional hazard assumption.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(sfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         chisq df     p
age      0.186  1 0.666
sex      2.059  1 0.151
ph.ecog  1.359  1 0.244
ph.karno 4.916  1 0.027
wt.loss  0.110  1 0.740
GLOBAL   7.174  5 0.208</code></pre>
</div>
</div>
<p>Plot fit of survival model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoxdiagnostics</span>(sfit, <span class="at">type =</span> <span class="st">"deviance"</span>, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a> <span class="at">ox.scale =</span> <span class="st">"linear.predictions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `gather_()` was deprecated in tidyr 1.2.0.
ℹ Please use `gather()` instead.
ℹ The deprecated feature was likely used in the survminer package.
  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-6-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Forest plot of outcome from survival analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggforest</span>(sfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-6-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An alternative way to display the output from Cox regression is to use <em>forestmodel</em> library .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>forestmodel<span class="sc">::</span><span class="fu">forest_model</span>(sfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-6-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The pseudoR2 for Cox regression model proposed by Royston can be evaluated</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">royston</span>(sfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        D     se(D)       R.D      R.KO       R.N      C.GH 
0.8546894 0.1495706 0.1484960 0.1515108 0.1459168 0.6418894 </code></pre>
</div>
</div>
</section>
<section id="quantile-regression" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="quantile-regression"><span class="header-section-number">6.5.3</span> Quantile regression</h3>
<p>Least spare regression is appropriate when the data is homoscedascity or the error term remain constant. This can be seen as the data varies around the fitted line. Homoscedascity implies that the data is homogenous. Quantile regression is appropriate when the distribution of the data is non-normal and it is more appropriate to look at the conditional median of the dependent variable. There are several libraries for this task <em>quantreg</em> and Bayesian libraries. In the example below, the life time risk of stroke is regressed against life expectancy using lest square and quantile regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"./Data-Use/world_stroke.Rda"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#quantile regression</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>rqfit <span class="ot">&lt;-</span> <span class="fu">rq</span>( MeanLifetimeRisk<span class="sc">~</span> LifeExpectancy, <span class="at">data =</span> world_sfdf)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>rqfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(rqfit)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">#least square regression</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>lsfit<span class="ot">&lt;-</span><span class="fu">lm</span>(MeanLifetimeRisk<span class="sc">~</span>LifeExpectancy,<span class="at">data=</span>world_sfdf)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>lsfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(lsfit) </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf,  <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add fitted line for least square</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add fitted line for quantile regression</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#annotate least square and quantile at position x, y</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#annotate("text",x=60, y=27, label=paste0("least square =",                        round(lsfit_sum$coefficients[1],2) ,"+", round(lsfit_sum$coefficients[2],2),"x ","Life Expectancy"),color="red")+ annotate("text",x=75, y=12,label=paste0("quantile =",round(rqfit_sum$coefficients[1],2), " + ", round(rqfit_sum$coefficients[2],2)," x ","Life Expectancy"),color="blue")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="non-negative-regression" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4" class="anchored" data-anchor-id="non-negative-regression"><span class="header-section-number">6.5.4</span> Non-negative regression</h3>
<p>In certain situations, it is necessary to constrain the analysis so that the regression coefifcients are non-negative. For example, when regressing brain regions against infarct volume, there is no reason believe that a negative coefficient attributable to a brain region is possible<span class="citation" data-cites="pmid16504541">(<a href="references.html#ref-pmid16504541" role="doc-biblioref">Phan, Donnan, Koga, et al. 2006</a>)</span> . Non-negative regression can be performed in R using <em>nnls</em>.</p>
</section>
<section id="poisson-regression" class="level3" data-number="6.5.5">
<h3 data-number="6.5.5" class="anchored" data-anchor-id="poisson-regression"><span class="header-section-number">6.5.5</span> Poisson regression</h3>
<p>Poisson regression is used when dealing with number of event over time or distance such as number of new admissions or new cases of hepatitis or TIA over time. An assumption of the Poisson distribution is that the mean &amp; lambda; and variance λ are the same.</p>
<p>A special case of Poisson regression is the negative binomial regression. This latter method is used when the variance is greater than the mean pf the data or over-dispersed data. Negative binomial regression can be applied to number of ‘failure’ event over time. Here ‘failure’ has a lose definition and can be stroke recurrence after TIA or cirrhosis after hepatitis C infection.</p>
<p>Zero-inflated data occurs when there is an abundance of zeroes in the data (true and excess zeroes).</p>
</section>
<section id="conditional-logistic-regression" class="level3" data-number="6.5.6">
<h3 data-number="6.5.6" class="anchored" data-anchor-id="conditional-logistic-regression"><span class="header-section-number">6.5.6</span> Conditional logistic regression</h3>
<p>Conditional logistical regression model should be used when the aim is to compare pair of objects from the same patient. Examples include left and right arms or left and right carotid arteries. This method is available from <em>clogit</em> in <em>survival</em>.</p>
</section>
<section id="multinomial-modelling" class="level3" data-number="6.5.7">
<h3 data-number="6.5.7" class="anchored" data-anchor-id="multinomial-modelling"><span class="header-section-number">6.5.7</span> Multinomial modelling</h3>
<p>Multinomial modelling is used when the outcome categorical variables are not ordered. This situation can occur when analysis involves choice outcome (choices of fruit: apple, orange or pear). In this case, the log odds of each of the categorical outcomes are analysed as a linear combination of the predictor variables. The <em>nnet</em> library have functions for performing this analysis.</p>
</section>
</section>
<section id="sample-size-estimation" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="sample-size-estimation"><span class="header-section-number">6.6</span> Sample size estimation</h2>
<p>Clinicians are often frustrated about sample size and power estimation for a study, grant or clinical trial. This aspect is scrutinised by ethics committee and in peer review process for journals. Luckily, R provides several packages for sample size amd power estimation: <em>pwr</em> library. Cohen has written reference textbook on this subject <span class="citation" data-cites="COHEN1977179">(<a href="references.html#ref-COHEN1977179" role="doc-biblioref">Cohen 1977</a>)</span>.</p>
<section id="proportion" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="proportion"><span class="header-section-number">6.6.1</span> Proportion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ttest-d is effect size </span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#d = )mean group1 -mean group2)/variance</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n=</span><span class="dv">300</span>,<span class="at">d=</span><span class="fl">0.2</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>,<span class="at">alternative=</span><span class="st">"greater"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 300
              d = 0.2
      sig.level = 0.05
          power = 0.7886842
    alternative = greater

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>We provided an example below for generating power of clinical trial. Examples are taken from a paper on sample size estimation for phase II trials <span class="citation" data-cites="pmid16931782">(<a href="references.html#ref-pmid16931782" role="doc-biblioref">Phan, Donnan, Davis, et al. 2006</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#h is effect size. effect size of 0.5 is very large </span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.5</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Difference of proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.5
              n = 50
      sig.level = 0.05
          power = 0.705418
    alternative = two.sided

NOTE: same sample sizes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#medium effect size</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Difference of proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.1
              n = 50
      sig.level = 0.05
          power = 0.07909753
    alternative = two.sided

NOTE: same sample sizes</code></pre>
</div>
</div>
<p>The output of the sample size calculation can be put into a table or plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pwr.2p.test(h=0.3,n=80,sig.level=0.05,alternative="two.sided")</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">1</span>) <span class="co">#from 0.1 to 0.3 by 0.05</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>nh <span class="ot">&lt;-</span> <span class="fu">length</span>(h) <span class="co">#5</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">3</span>,.<span class="dv">9</span>,.<span class="dv">1</span>)<span class="co"># power from 0.5 to 0.9 by 0.1</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(p) <span class="co">#9</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty array 9 x 5</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">numeric</span>(nh<span class="sc">*</span>np), <span class="at">dim=</span><span class="fu">c</span>(nh,np))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nh){</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">pwr.2p.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">h =</span> h[j],</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#result &lt;- pwr.r.test(n = NULL, h = h[j],</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> p[i],</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    samplesize[j,i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>samplesize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]  412  583  769  980 1235 1570 2102
[2,]  103  146  193  245  309  393  526
[3,]   46   65   86  109  138  175  234
[4,]   26   37   49   62   78   99  132
[5,]   17   24   31   40   50   63   85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#graph</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> <span class="fu">range</span>(h)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">range</span>(samplesize))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(p))</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xrange, yrange, <span class="at">type=</span><span class="st">"n"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">"Effect size (h)"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">"Sample Size (n)"</span> )</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add power curves</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(h, samplesize[,i], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>colors[i])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotation (grid lines, title, legend) </span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">h=</span><span class="fu">seq</span>(<span class="dv">0</span>,yrange[<span class="dv">2</span>],<span class="dv">50</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"grey89"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="fu">seq</span>(xrange[<span class="dv">1</span>],xrange[<span class="dv">2</span>],.<span class="dv">02</span>), <span class="at">lty=</span><span class="dv">2</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">col=</span><span class="st">"grey89"</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sample Size Estimation</span><span class="sc">\n</span><span class="st"> Difference in Proportion"</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">title=</span><span class="st">"Power"</span>, <span class="fu">as.character</span>(p),</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>   <span class="at">fill=</span>colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="non-inferiority" class="level4" data-number="6.6.1.1">
<h4 data-number="6.6.1.1" class="anchored" data-anchor-id="non-inferiority"><span class="header-section-number">6.6.1.1</span> Non-inferiority</h4>
<p>Non-inferiority trials may offer information in a way that a traditional superiority design do not. The design may be interested in other aspect of the treatment such as cost and lower toxicity <span class="citation" data-cites="pmid26080342">(<a href="references.html#ref-pmid26080342" role="doc-biblioref">Kaji and Lewis 2015</a>)</span>. Examples of non-inferiority trial designs include antibiotics versus surgery for appendicitis <span class="citation" data-cites="pmid26080338">(<a href="references.html#ref-pmid26080338" role="doc-biblioref">Salminen et al. 2015</a>)</span>. There are concerns with reporting of noninferiority trial. Justification for the margin provided in 27.6% <span class="citation" data-cites="pmid25781447">(<a href="references.html#ref-pmid25781447" role="doc-biblioref">Gopal et al. 2015</a>)</span>. The following describes a trial design where it’s expected that drug will result in a certain outcome <em>p1</em> and the control arm <em>p2</em> and the ratio of subject in treatment to control arm is <em>k</em>. The difference in outcome is <em>delta</em>. The margin is defined as non-inferior if &lt;0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TrialSize)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TwoSampleProportion.NIS</span>(<span class="at">alpha=</span>.<span class="dv">05</span>, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">beta=</span>.<span class="dv">8</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">p1=</span>.<span class="dv">6</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">p2=</span>.<span class="dv">7</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">k=</span><span class="dv">1</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">delta =</span> .<span class="dv">1</span>,       </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">margin=</span><span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.225911</code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-1" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="logistic-regression-1"><span class="header-section-number">6.6.2</span> Logistic regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(powerMediation)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#continuous predictor</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co">#p1=event rate</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">#exp(0.405) =1.5</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">p1=</span><span class="fl">0.265</span>, <span class="at">OR=</span><span class="fu">exp</span>(<span class="fl">0.014</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03056289</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a data frame using data from </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">05.4</span>,<span class="fl">0.05</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>df_power<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">`</span><span class="at">ASPECTS</span><span class="st">`</span><span class="ot">=</span> a,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="st">"Power"</span><span class="ot">=</span><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">p1=</span>a, <span class="at">OR=</span><span class="fu">exp</span>(.<span class="dv">695</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(n * beta.star^2 * p1 * (1 - p1)): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_power, <span class="fu">aes</span>(<span class="at">x=</span>ASPECTS, <span class="at">y=</span>Power))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 88 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An alternative library to perform sample size for logistic regression is <em>WebPower</em> library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WebPower) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lme4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lme4'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:modeltools':

    refit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:nlme':

    lmList</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatrixModels':

    mkRespMod</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:generics':

    refit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lavaan</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-15
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: PearsonDS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wp.logistic</span>(<span class="at">p0=</span><span class="fl">0.007</span>, <span class="co">#Prob (Y=1|X=0) </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">p1=</span><span class="fl">0.012</span>, <span class="co">#Prob (Y=1|X=1)</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.05</span>, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">power=</span><span class="fl">0.80</span>, </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative=</span><span class="st">"two.sided"</span>, </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">family=</span><span class="st">"normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for logistic regression

       p0    p1     beta0     beta1      n alpha power
    0.007 0.012 -4.954821 0.5440445 3336.2  0.05   0.8

URL: http://psychstat.org/logistic</code></pre>
</div>
</div>
</section>
<section id="survival-studies" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="survival-studies"><span class="header-section-number">6.6.3</span> Survival studies</h3>
<p>Sample size for survival studies can be performed using <em>powerSurvEpi</em> or <em>gsDesign</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(powerSurvEpi)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ssizeEpi.default</span>(<span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span> , </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.15</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#power</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">powerEpi.default</span>(<span class="at">n =</span> <span class="dv">2691</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span>, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.250</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Amarenco NEJM 2020 #equal sample size k=1</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssizeCT.default</span>(<span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">k =</span> .<span class="dv">8</span>, <span class="at">pE =</span> <span class="fl">0.085</span>, </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">pC =</span> <span class="fl">0.109</span>, </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">RR =</span> <span class="fl">0.78</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nE   nC 
2417 3021 </code></pre>
</div>
</div>
</section>
<section id="multiple-regression" class="level3" data-number="6.6.4">
<h3 data-number="6.6.4" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">6.6.4</span> Multiple regression</h3>
<p>The power for general linear model can be calculated using the <em>pwr.f2.test</em> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#u=degrees of freedom for numerator</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#v=degrees of freedomfor denominator</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#f2=effect size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="randomised-clinical-trials" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="randomised-clinical-trials"><span class="header-section-number">6.7</span> Randomised clinical trials</h2>
<p>A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment<span class="citation" data-cites="pmid15345796">(<a href="references.html#ref-pmid15345796" role="doc-biblioref">Ingall et al. 2004</a>)</span>. There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<section id="covariate-adjustment-in-trials" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="covariate-adjustment-in-trials"><span class="header-section-number">6.7.1</span> Covariate adjustment in trials</h3>
<p>Specifically, covariate adjustment refers to adjustment of covariates available at the time of randomisation, i.e.&nbsp;prespecified variables and not variables after randomisation such as pneumonia post stroke trials. The advantage of covariate adjustment is that it results in narrower confidence interval as well as increase the power of the trial up to 7% <span class="citation" data-cites="10.1186/1745-6215-15-139">(<a href="references.html#ref-10.1186/1745-6215-15-139" role="doc-biblioref">Kahan 2014</a>)</span>. The increased power is highest when prognostic variables are used but can decrease power when non-prognostic variables are used <span class="citation" data-cites="10.1186/1745-6215-15-139">(<a href="references.html#ref-10.1186/1745-6215-15-139" role="doc-biblioref">Kahan 2014</a>)</span>.</p>
</section>
<section id="subgroup-analysis" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="subgroup-analysis"><span class="header-section-number">6.7.2</span> Subgroup analysis</h3>
<p>Subgroup analysis can be misleading especially if not specified prior to trial analysis <span class="citation" data-cites="doi:10.1056/NEJMsr077003">(<a href="references.html#ref-doi:10.1056/NEJMsr077003" role="doc-biblioref">Wang et al. 2007</a>)</span>. Furthermore, increasing the number of subgroup analysis will lead to increasing the chance of false positive result or multiplicity. It is important to differentiate between prespecified and posthoc analyses as posthoc analyses may be biased by examination of the data.</p>
</section>
<section id="p-value-for-interaction" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="p-value-for-interaction"><span class="header-section-number">6.7.3</span> p value for interaction</h3>
<p>The p value for interaction describe the influence by a baseline variable treatment effect on outcome in clinical trial <span class="citation" data-cites="doi:10.1056/NEJMsr077003">(<a href="references.html#ref-doi:10.1056/NEJMsr077003" role="doc-biblioref">Wang et al. 2007</a>)</span>. In a hypothetical trial, a significant p value for interaction between males and females for treatment effect on primary outcome indicates heterogenity of treatment effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Publish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Publish' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: prodlim</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'Publish':
  method   from
  print.ci coin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-risk-reduction-in-clinical-trials" class="level3" data-number="6.7.4">
<h3 data-number="6.7.4" class="anchored" data-anchor-id="interpreting-risk-reduction-in-clinical-trials"><span class="header-section-number">6.7.4</span> Interpreting risk reduction in clinical trials</h3>
<p>A key issue in interpreting of clinical trials occurs when the relative risk reduction or relative hazard risk are provided. This issue affect the clinical interpretation of the trial finding and its application in practice. An example is the result of the ACAS asymptomatic carotid artery trial is often quoted as showing 50% risk reduction. In fact, there was 2% annual risk of ipsilateral stroke in the medical and 1% risk in the surgical arm. The absolute risk reduction or ARR was 1% per year. However, the 50% relative risk reduction is often quoted to explain to patients.</p>
</section>
<section id="nnt-from-arr" class="level3" data-number="6.7.5">
<h3 data-number="6.7.5" class="anchored" data-anchor-id="nnt-from-arr"><span class="header-section-number">6.7.5</span> NNT from ARR</h3>
<p>In this case, the number needed to treat (NNT) is given by <span class="math inline">\(\frac{1}{ARR}\)</span> or <span class="math inline">\(\frac{1}{0.01}=100\)</span> to achieve the trial outcome or 100 patients are needed to be treated to reduce the stroke risk to 1%. The recommendation is that the 95% confidence interval for NNT should be provided.</p>
</section>
<section id="nnt-from-odds-ratio" class="level3" data-number="6.7.6">
<h3 data-number="6.7.6" class="anchored" data-anchor-id="nnt-from-odds-ratio"><span class="header-section-number">6.7.6</span> NNT from odds ratio</h3>
<p>Calculation of NNT for odds ratio requires knowledge of the outcome of the placebo group. The NNT is given by <span class="math inline">\(\frac{1}{ACR-\frac{OR*ACR}{1-(ACR+OR*ACR)}}\)</span>. The ACR represents the assumed control risk. The NNT can be calculated from <em>nnt</em> function in <em>meta</em> library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'meta' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: metadat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'meta' package (version 7.0-0).
Type 'help(meta)' for a brief overview.
Readers of 'Meta-Analysis with R (Use R!)' should install
older version of 'meta' package: https://tinyurl.com/dt4y5drs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p.c = baseline risk</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">0.73</span>, <span class="at">p.c =</span> <span class="fl">0.3</span>, <span class="at">sm =</span> <span class="st">"OR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    OR p.c      NNT
1 0.73 0.3 16.20811</code></pre>
</div>
</div>
</section>
<section id="nnt-from-risk-ratio" class="level3" data-number="6.7.7">
<h3 data-number="6.7.7" class="anchored" data-anchor-id="nnt-from-risk-ratio"><span class="header-section-number">6.7.7</span> NNT from risk ratio</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data from EXTEND-IV trial in NEJM 2019</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#outcome 35.4% in tpa and 29.5% in control</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">1.44</span>, <span class="at">p.c =</span> <span class="fl">0.295</span>, <span class="at">sm =</span> <span class="st">"RR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    RR   p.c      NNT
1 1.44 0.295 -7.70416</code></pre>
</div>
</div>
</section>
<section id="nnt-from-hazard-ratio" class="level3" data-number="6.7.8">
<h3 data-number="6.7.8" class="anchored" data-anchor-id="nnt-from-hazard-ratio"><span class="header-section-number">6.7.8</span> NNT from hazard ratio</h3>
<p>Calculation of NNT for hazard ratio requires knowledge of the outcome of the placebo group and the hazard ratio or <em>HR</em>. The formula using the binomial theorem is <span class="math inline">\(p=1-q\)</span> where q is given by the ratio of outcome and numbers recruited in the placebo group. The formula is taken from <span class="citation" data-cites="pmid32404155">(<a href="references.html#ref-pmid32404155" role="doc-biblioref">Ludwig, Darmon, and Guerci 2020</a>)</span> . The NNT is given <span class="math inline">\(\frac{1}{[p^{HR}-p}\)</span> . We illustrated this using data from metaanalysis on aspirin use in stroke in Lancet 2016. There were 45 events among 16053 patients in the control group. The HR was 0.44. The NNT from this formula <span class="math inline">\(\frac{1}{.9971968^.44-.9971968}\)</span> was 637.</p>
</section>
<section id="nnt-from-metaananlysis" class="level3" data-number="6.7.9">
<h3 data-number="6.7.9" class="anchored" data-anchor-id="nnt-from-metaananlysis"><span class="header-section-number">6.7.9</span> NNT from metaananlysis</h3>
<p>There are concerns with using NNT from the results of metaanalysis as the findings are amalgations of trials with different settings <span class="citation" data-cites="pmid12614141">(<a href="references.html#ref-pmid12614141" role="doc-biblioref">Marx 2003</a>)</span> <span class="citation" data-cites="pmid10356018">(<a href="references.html#ref-pmid10356018" role="doc-biblioref">Smeeth 1999</a>)</span>. The caution applies when baseline risks or absolute risk differences vary across trials.</p>
</section>
</section>
<section id="diagnostic-test" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="diagnostic-test"><span class="header-section-number">6.8</span> Diagnostic test</h2>
<section id="sensitivity-specificity" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="sensitivity-specificity"><span class="header-section-number">6.8.1</span> Sensitivity, specificity</h3>
<p>The sensitivity of a diagnostic test is the true positive rate and the specificity is the true negative rate. Example of 2 x 2 table is provided here. As an exercise, consider a paper about a diagnostic test for peripheral vertigo reporting 100% sensitivity and 94.4% specificity. There are 114 patients, 72 patients without stroke have vertigo and positive test findings. Among patients with stroke 7 of 42 have positive test findings. The sensitivity is <span class="math inline">\(TP=\frac{TP}{TP+FN}\)</span> and the specificity is the <span class="math inline">\(TN=\frac{TN}{TN+FP}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#              Peripheral Vertigo</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co">#            Disease Positive     Disease Negative</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive# True Positive   # False Positive       $  </span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         #     72          #       7              $</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative# False Negative  # True Negative        $</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         #     0           #       35             $ </span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Peripheral Vertigo</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Sensitiviy=TP/(TP+FN)=100%</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Specificity=TN/(TN+FP)=83%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="auc" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="auc"><span class="header-section-number">6.8.2</span> AUC</h3>
<p>The area under the receiver operating characteristics (ROC) curve or AUC is a measure of the accuracy of the test. It is recommended that ROC curve is used when there are multiple threshold. It should not be used when the test has only one threshold. Some investigators suggest caution regarding the validity of using receiver operating curve with single threshold diagnostic tests <span class="citation" data-cites="pmid33250548">(<a href="references.html#ref-pmid33250548" role="doc-biblioref">J 2020</a>)</span>. An AUC of 0.5 is classified as no better than by chance; 0.6–0.69 provides poor discrimination; 0.7–0.79 provides acceptable (fair) discrimination, 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination.</p>
</section>
<section id="likelihood-ratio" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="likelihood-ratio"><span class="header-section-number">6.8.3</span> Likelihood ratio</h3>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with ICH (target disorder) compared with the likelihood that the same result would be expected in a patient without ICH. Using the recommendation by Jaeschke et al, a high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk. PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk .</p>
<section id="fagans-normogram" class="level4" data-number="6.8.3.1">
<h4 data-number="6.8.3.1" class="anchored" data-anchor-id="fagans-normogram"><span class="header-section-number">6.8.3.1</span> Fagan’s normogram</h4>
<p>Fagan’s normogram can be conceptualised as a sliding ruler to match the disease prevalence and likelihood ratios to evaluate the impact on the post-test probability <span class="citation" data-cites="pmid1143310">(<a href="references.html#ref-pmid1143310" role="doc-biblioref">TJ 1975</a>)</span>. At the current disease prevalence of 23.4% and PLR 4.65, the post-test probability remains low at 0.60.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Fagan's normogram for Spot Sign and ICH growth"</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co">#to save the file</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(p,file="Fagan_SpotSign.png",width=5.99,height=3.99,units="in")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="likelihood-ratio-graph" class="level4" data-number="6.8.3.2">
<h4 data-number="6.8.3.2" class="anchored" data-anchor-id="likelihood-ratio-graph"><span class="header-section-number">6.8.3.2</span> Likelihood ratio graph</h4>
<p>Likelihood ratio graph is a tool for comparing diagnostic tests <span class="citation" data-cites="pmid10700737">(<a href="references.html#ref-pmid10700737" role="doc-biblioref">BJ 2000</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot likelihood ratio graph</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>LR_graph<span class="ot">&lt;-</span><span class="cf">function</span> (Read,sheet,Sensitivity, Specificity){</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  Read1<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(Read, <span class="at">sheet =</span> sheet)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#binary data</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#A=True pos %B=False positive   %C=False negative   %D=True negative</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  A<span class="ot">=</span>Read1<span class="sc">$</span>TP</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">=</span>Read1<span class="sc">$</span>FP</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  C<span class="ot">=</span>Read1<span class="sc">$</span>FN</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span>Read1<span class="sc">$</span>TN</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  TPR<span class="ot">=</span>A<span class="sc">/</span>(A<span class="sc">+</span>C)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  FPR<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(D<span class="sc">/</span>(D<span class="sc">+</span>B))</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  TPR_DiagnosticTest<span class="ot">=</span>Sensitivity</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  FPR_DiagnosticTest<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>Specificity</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set plot</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(X,Y,<span class="at">main=</span><span class="st">"Likelihood Ratio graph"</span>, <span class="at">xlab=</span><span class="st">"1-Specificity"</span>,<span class="at">ylab=</span><span class="st">"Sensitivity"</span>,<span class="at">cex=</span>.<span class="dv">25</span>)</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 1 corresponds o</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(FPR_DiagnosticTest,TPR_DiagnosticTest,<span class="at">pch=</span><span class="dv">8</span>,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 8 corresponds *</span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(FPR,TPR,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="dv">2</span>) <span class="co">#add point</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#abline(coef = c(0,1)) #add diagonal line</span></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>  df1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(<span class="dv">0</span>,TPR_DiagnosticTest),<span class="at">c2=</span><span class="fu">c</span>(<span class="dv">0</span>,FPR_DiagnosticTest))</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>  reg1<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df1)</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>  df2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(TPR_DiagnosticTest,<span class="dv">1</span>),<span class="at">c2=</span><span class="fu">c</span>(FPR_DiagnosticTest,<span class="dv">1</span>))</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>  reg2<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df2)</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(reg1)</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(reg2)</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.3</span>,<span class="at">label=</span><span class="st">"Superior"</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">label=</span><span class="st">"Absence"</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">0125</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">-.1</span>,<span class="at">label=</span><span class="st">"Presence"</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.1</span>,<span class="at">y=</span>TPR_DiagnosticTest,<span class="at">label=</span><span class="st">"Inferior"</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">2</span>,<span class="at">label=</span><span class="st">"Reference = Content Expert"</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">15</span>, <span class="at">label=</span><span class="st">"Diagnostic Test software"</span>, <span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Runnning the function from above</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sensitivity=0.623</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Specificity=1-.927</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">LR_graph</span>(<span class="st">"./Data-Use/Diagnostic_test_summary.xlsx"</span>,<span class="dv">1</span>,.<span class="dv">623</span>,.<span class="dv">927</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...11`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-14-3-3-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="metaanalysis" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="metaanalysis"><span class="header-section-number">6.9</span> Metaanalysis</h2>
<p>During journal club, junior doctors are often taught about the importance of metaanalysis. It is worth knowing how to perform a metaanalysis in order to critique the study. This is an important issue as the junior doctor is supervised by someone who a content expert but not necessarily a method expert. Metaanalysis can be performed for clinical trials, cohort studies or diagnostic studies. As an example, it is not well known outside of statistics journal that the bivariate analysis is the preferred method to evaluate diagnostic studies <span class="citation" data-cites="pmid16168343">(<a href="references.html#ref-pmid16168343" role="doc-biblioref">Reitsma et al. 2005</a>)</span>. By contrast, the majority of metaanalysis of diagnostic studies uses the univariate method of Moses and Littenberg <span class="citation" data-cites="pmid8210827">(<a href="references.html#ref-pmid8210827" role="doc-biblioref">Moses, Shapiro, and Littenberg 1993</a>)</span>. This issue will be expanded below.</p>
<section id="quality-of-study" class="level3" data-number="6.9.1">
<h3 data-number="6.9.1" class="anchored" data-anchor-id="quality-of-study"><span class="header-section-number">6.9.1</span> Quality of study</h3>
<p>All studies require evaluation of the quality of the individual studies. This can be done with the QUADAS2 tool, available at <a href="https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies." class="uri">https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies.</a></p>
</section>
<section id="prisma" class="level3" data-number="6.9.2">
<h3 data-number="6.9.2" class="anchored" data-anchor-id="prisma"><span class="header-section-number">6.9.2</span> PRISMA</h3>
<p>The PRISMA statement is useful for understanding the search strategy and the papers removed and retained in the metaanalysis. An example of generating the statement is provided below in R. The example given here is from a paper on the use of spot sign to predict enlargment of intracerebral hemorrhage <span class="citation" data-cites="pmid31272327">(<a href="references.html#ref-pmid31272327" role="doc-biblioref">Phan et al. 2019</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3200b6e1a7817ef2f367" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3200b6e1a7817ef2f367">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rich-iannone.github.io/DiagrammeR/graphviz_and_mermaid.html#attributes</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">"</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="st">digraph boxes_and_circles {</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # a 'graph' statement</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="st">  graph [overlap = true, fontsize = 10]</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="st">  # several 'node' statements</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape = box,</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="st">        fontname = Helvetica]</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Stroke</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape = oval,</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="st">        fixedsize = false,</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="st">        color=red,</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="st">        width = 0.9] </span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Hypertension; 'No Hypertension'</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape= circle,</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="st">  fontcolor=red,</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="st">        color=blue,</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="st">        fixedsize=false]</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a><span class="st">  Hypokalemia; 'No Hypokalemia'        </span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="st">  # several 'edge' statements</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a><span class="st">  edge [arrowhead=diamond]</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a><span class="st">  Stroke-&gt;{Hypertension, 'No Hypertension'}</span></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a><span class="st">  Hypertension-&gt;{Hypokalemia, 'No Hypokalemia'}</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-80ebb79959662dd52d38" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-80ebb79959662dd52d38">{"x":{"diagram":"\ndigraph boxes_and_circles {\n\n  # a \"graph\" statement\n  graph [overlap = true, fontsize = 10]\n\n  # several \"node\" statements\n  node [shape = box,\n        fontname = Helvetica]\n  Stroke\n\n  node [shape = oval,\n        fixedsize = false,\n        color=red,\n        width = 0.9] \n  Hypertension; \"No Hypertension\"\n  \n  node [shape= circle,\n  fontcolor=red,\n        color=blue,\n        fixedsize=false]\n\n  Hypokalemia; \"No Hypokalemia\"        \n\n  # several \"edge\" statements\n  edge [arrowhead=diamond]\n  \n  Stroke->{Hypertension, \"No Hypertension\"}\n  Hypertension->{Hypokalemia, \"No Hypokalemia\"}\n  \n}\n\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">"digraph flowchart {</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="st">      # node definitions with substituted label text</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="st">      node [fontname = Helvetica, shape = rectangle]        </span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 [label = '@@1']</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 [label = '@@2']</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="st">      tab3 [label = '@@3']</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="st">      tab4 [label = '@@4']</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="st">      tab5 [label = '@@5']</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="st"># edge definitions with the node IDs</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1 -&gt; tab3 </span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="st">      tab1-&gt; tab2 </span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="st">      #tab2-&gt;tab3</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2 -&gt; tab4 </span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a><span class="st">      tab2-&gt; tab5;</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="st">      [1]: 'Stroke n=19'</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a><span class="st">      [2]: 'Hypertension n=10'</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a><span class="st">      [3]: 'No Hypertension n=9'</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a><span class="st">      [4]: 'Hypokalemia n=?'</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a><span class="st">      [5]: 'No Hypokalemia n=?'</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1a7a0123280493dd45a1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1a7a0123280493dd45a1">{"x":{"diagram":"digraph flowchart {\n      # node definitions with substituted label text\n      node [fontname = Helvetica, shape = rectangle]        \n      tab1 [label = \"Stroke n=19\"]\n      tab2 [label = \"Hypertension n=10\"]\n      tab3 [label = \"No Hypertension n=9\"]\n      tab4 [label = \"Hypokalemia n=?\"]\n      tab5 [label = \"No Hypokalemia n=?\"]\n\n \n# edge definitions with the node IDs\n      tab1 -> tab3 \n      tab1-> tab2 \n      #tab2->tab3\n      tab2 -> tab4 \n      tab2-> tab5;\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="conversion-of-median-to-mean" class="level3" data-number="6.9.3">
<h3 data-number="6.9.3" class="anchored" data-anchor-id="conversion-of-median-to-mean"><span class="header-section-number">6.9.3</span> Conversion of median to mean</h3>
<p>One issue with performing metaanalysis is that one paper may report mean and another report median age. The formula for the mean is given by <span class="math inline">\(\frac{a+2m+b}{4}\)</span> where <em>m</em> is the median, <em>a</em> is the upper and <em>b</em> is the lower range <span class="citation" data-cites="pmid25524443">(<a href="references.html#ref-pmid25524443" role="doc-biblioref">Wan 2014</a>)</span>. The variance is given by <span class="math inline">\(S^2=\frac{1}{12}(\frac{(a+2m+b)^2}{4}+{(b-a)^2})\)</span>. This formula requires examination of the data such as the figure to obtain the upper and lower range. These changes are incorporated into <em>meta</em> libray using <em>meatamean</em> function <span class="citation" data-cites="doi10.1136/ebmental-2019-300117">(<a href="references.html#ref-doi10.1136/ebmental-2019-300117" role="doc-biblioref">Balduzzi, Rücker, and Schwarzer 2019</a>)</span>. More recently, investigators suggest to also consider the skewness of the data from the 5 number summary data <span class="citation" data-cites="pmid37161735">(<a href="references.html#ref-pmid37161735" role="doc-biblioref">Shi et al. 2023</a>)</span>. The argument <em>method.mean</em> in function <em>metamean</em> is used to specify the method for estimating the mean. In this case we chose the Luo method for illustration Luo <span class="citation" data-cites="doi:10.1177/0962280216669183">(<a href="references.html#ref-doi:10.1177/0962280216669183" role="doc-biblioref">Luo et al. 2018</a>)</span>. See the help page by typing question mark before <em>metamean</em> for more options.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(meta)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#NIHSS data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">"Luo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of observations: o = 230

    mean             95%-CI
 13.1932 [11.6506; 14.7358]

Details:
- Untransformed (raw) means</code></pre>
</div>
</div>
<p>Here the same data is used for the McGrath method <span class="citation" data-cites="doi:10.1177/0962280219889080">(<a href="references.html#ref-doi:10.1177/0962280219889080" role="doc-biblioref">McGrath et al. 2020</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">"QE-McGrath"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of observations: o = 230

    mean             95%-CI
 13.3333 [11.7907; 14.8759]

Details:
- Untransformed (raw) means</code></pre>
</div>
</div>
<p>The conversion from median to mean in <em>metafor</em> is performed using <em>conv.fivenum</em> function <span class="citation" data-cites="JSSv036i03">(<a href="references.html#ref-JSSv036i03" role="doc-biblioref">Viechtbauer 2010</a>)</span>. There is an update on the <em>metafor</em> page as well as discussion on alternate approach. The default method of this function is to use the methods by Luo <span class="citation" data-cites="doi:10.1177/0962280216669183">(<a href="references.html#ref-doi:10.1177/0962280216669183" role="doc-biblioref">Luo et al. 2018</a>)</span>, Wan <span class="citation" data-cites="pmid25524443">(<a href="references.html#ref-pmid25524443" role="doc-biblioref">Wan 2014</a>)</span> and Shi <span class="citation" data-cites="pmid37161735">(<a href="references.html#ref-pmid37161735" role="doc-biblioref">Shi et al. 2023</a>)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: numDeriv</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Loading the 'metafor' package (version 4.2-0). For an
introduction to the package please type: help(metafor)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'metafor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:rms':

    vif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example data frame</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Paper=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="cn">NA</span>), <span class="at">min=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="cn">NA</span>,<span class="dv">2</span>,<span class="cn">NA</span>), <span class="at">q1=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="cn">NA</span>),</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">median=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="cn">NA</span>), <span class="at">q3=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="cn">NA</span>),</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">14</span>,<span class="cn">NA</span>,<span class="dv">14</span>,<span class="cn">NA</span>),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">7.0</span>), <span class="at">sd=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">4.2</span>),</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>))</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>EstMean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Paper min q1 median q3 max mean  sd  n
1     1   1 NA      5 NA  12   NA  NA 30
2     2   2 NA      6 NA  14   NA  NA 30
3     3  NA  4      6 10  NA   NA  NA 30
4     4   2  4      6 10  14   NA  NA 30
5    NA  NA NA     NA NA  NA    7 4.2 30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">conv.fivenum</span>(<span class="at">min=</span>min, <span class="at">q1=</span>q1, <span class="at">median=</span>median, <span class="at">q3=</span>q3, <span class="at">max=</span>max, <span class="at">n=</span>n, <span class="at">data=</span>EstMean)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>EstMean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Paper min q1 median q3 max     mean       sd  n
1     1   1 NA      5 NA  12 5.356748 2.695707 30
2     2   2 NA      6 NA  14 6.475664 2.940771 30
3     3  NA  4      6 10  NA 6.713000 4.670521 30
4     4   2  4      6 10  14 6.882074 3.546379 30
5    NA  NA NA     NA NA  NA 7.000000 4.200000 30</code></pre>
</div>
</div>
<p>The <em>estmeansd</em> library uses quantile estimation method with <em>qe.mean.sd</em> function when the data available are the median and quartile ranges <span class="citation" data-cites="doi:10.1177/0962280219889080">(<a href="references.html#ref-doi:10.1177/0962280219889080" role="doc-biblioref">McGrath et al. 2020</a>)</span> <span class="citation" data-cites="pmid36412105">(<a href="references.html#ref-pmid36412105" role="doc-biblioref">McGrath et al. 2022</a>)</span>.The approach here is to use simulation to estimate the parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'estmeansd' was built under R version 4.3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>res_qe <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">q1.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">q3.val =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>res_qe </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$est.mean
[1] 17.03109

$est.sd
[1] 5.679235</code></pre>
</div>
</div>
<p>The standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_SE</span>(res_qe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$est.se
[1] 0.5085423

$boot_means
   [1] 17.63552 16.87911 17.21087 18.37835 17.06111 16.97324 16.28046 16.55440
   [9] 16.78779 17.52401 17.40252 16.71926 16.48587 16.71277 16.04041 16.64257
  [17] 16.58581 16.70409 17.00470 16.77632 16.49513 16.60758 16.53661 16.88875
  [25] 16.75412 16.83439 16.33413 17.02230 15.73261 16.76107 17.12523 17.79897
  [33] 16.77011 16.57370 17.60460 16.20365 16.68363 15.87538 16.14768 16.74994
  [41] 16.19223 16.31440 16.67760 16.92631 16.58194 17.63982 16.98768 16.79799
  [49] 17.81761 17.37270 16.16284 16.95356 17.16436 16.58675 17.34456 16.67638
  [57] 16.93804 16.10195 16.21442 17.29764 16.87307 17.45995 17.52932 15.64210
  [65] 16.96973 16.59971 17.13190 17.26831 16.04833 16.02095 17.44736 17.04858
  [73] 16.84683 16.64707 16.80557 16.92854 16.77352 17.19616 16.24818 17.31548
  [81] 16.45396 17.83763 16.82433 16.98244 15.90395 16.66238 16.18822 16.21253
  [89] 16.51635 16.57454 16.30615 17.09296 16.97888 17.23274 16.73336 15.98700
  [97] 17.59830 16.92804 16.68139 17.03789 17.80884 16.59474 16.38075 17.07557
 [105] 17.37840 17.41764 16.11332 16.45975 17.08136 17.43782 16.08813 16.68766
 [113] 16.77359 17.01063 16.78582 17.50333 16.22841 17.00464 16.51603 16.57905
 [121] 16.50499 17.53342 16.21646 17.57510 17.78446 16.88442 16.01006 16.87215
 [129] 16.90799 16.34539 16.84681 16.67253 17.68135 17.43595 16.46823 17.21019
 [137] 16.87364 16.38951 17.05552 16.81614 16.98286 15.55177 16.15975 16.63015
 [145] 16.26409 16.06795 16.32198 16.57136 17.03695 17.61712 16.82895 16.78381
 [153] 16.58484 17.03923 16.30591 16.33980 17.32183 16.40775 16.95587 17.10189
 [161] 16.62246 16.72860 16.68711 15.58347 16.18357 16.08777 17.02868 16.69470
 [169] 17.07870 16.63690 17.38398 16.01634 15.95888 16.41388 17.80851 16.38382
 [177] 15.69156 16.77367 16.68318 16.86527 16.10676 16.15706 16.50889 16.36605
 [185] 16.75247 16.01440 17.39575 15.18981 16.35576 17.42447 17.48124 17.56520
 [193] 17.22512 17.02615 16.93811 16.51312 16.67147 17.38068 16.15307 16.49037
 [201] 17.11752 16.90119 16.60430 17.66598 16.53494 17.34310 16.80526 16.69798
 [209] 15.80771 16.49769 17.15487 16.67788 17.00431 15.97433 16.01214 17.23063
 [217] 17.59082 16.84253 16.49650 16.40901 16.10897 16.85729 16.98999 16.09189
 [225] 17.78555 16.04921 16.81920 16.30538 17.01252 17.38448 16.07533 16.77924
 [233] 16.57485 17.01044 16.92117 15.73180 16.29477 16.47791 16.71082 16.98238
 [241] 16.45265 16.46845 16.47887 16.36484 17.28316 16.76334 16.54852 17.04406
 [249] 16.30830 16.65307 16.53896 16.99585 17.28862 16.82874 16.04059 16.27546
 [257] 16.49517 17.37655 17.20229 15.99516 16.29900 17.29727 16.87204 16.96384
 [265] 17.02871 15.78851 16.83398 16.27919 17.04721 17.81183 16.97610 16.81628
 [273] 17.41365 15.67946 16.74241 16.95546 17.55695 16.59957 17.00556 17.86511
 [281] 16.73909 16.79515 17.27563 17.67544 16.21734 16.52301 16.30101 17.30404
 [289] 16.14810 17.32469 17.10859 16.46948 16.64824 16.63864 16.05153 16.85465
 [297] 16.60245 16.61558 16.35863 16.49463 16.43246 16.49985 16.87394 16.46223
 [305] 16.47488 15.89976 17.23880 17.10292 16.65583 16.62990 17.36932 15.88606
 [313] 17.04108 16.60860 17.05643 16.35967 16.78415 17.12709 16.53318 16.78671
 [321] 16.42299 16.55961 16.92835 16.64938 15.99347 17.42448 16.25364 16.06757
 [329] 16.63060 16.66295 17.78741 16.32499 16.40065 16.64827 16.89543 15.97865
 [337] 17.07033 16.34788 16.07255 17.29919 16.21117 15.74121 16.33512 17.11237
 [345] 17.22494 17.41037 16.48544 16.02362 16.44553 16.47716 15.64336 16.63065
 [353] 16.50547 17.01520 16.73845 17.05422 16.39539 18.32118 17.29118 15.93682
 [361] 16.90967 16.61836 17.25013 17.43839 16.97900 16.75668 17.35165 16.63716
 [369] 15.72626 15.68603 16.89282 16.41987 16.52084 16.81461 16.15728 16.19314
 [377] 16.69038 16.16387 15.98129 17.45027 16.70883 16.87516 16.80841 17.10411
 [385] 16.93835 18.00270 16.29081 17.00014 17.94558 16.10689 16.74514 16.67284
 [393] 17.22999 17.34522 17.41020 17.09679 16.28240 16.17050 18.03588 16.25104
 [401] 17.02080 17.12400 17.28266 17.32945 17.46015 17.59566 15.98928 17.20812
 [409] 17.04153 16.94049 15.75573 17.12820 16.71464 16.93647 16.71871 16.63509
 [417] 16.38827 16.82314 16.67598 16.68090 16.78620 15.69594 15.88275 15.99963
 [425] 17.19889 17.72937 16.31546 16.64073 16.92743 16.85051 16.48294 17.12233
 [433] 16.01805 16.49165 16.00047 17.09865 17.39316 17.11191 16.15185 16.43014
 [441] 17.07281 18.03534 16.38008 17.01468 15.46617 16.75776 16.95159 16.16294
 [449] 16.78740 16.11695 16.81745 16.71993 16.62638 16.36986 16.78430 15.77901
 [457] 17.02946 16.84058 16.66577 17.30394 16.87219 16.73180 17.91247 16.35430
 [465] 15.99837 16.55911 16.65988 17.50261 16.91418 16.09610 16.96310 16.90376
 [473] 16.74703 16.88080 16.49425 16.85758 16.94536 16.40761 17.44453 17.08466
 [481] 16.45999 17.00926 17.20709 15.90013 16.29447 16.81261 16.18177 15.88284
 [489] 16.69738 16.81766 17.42055 16.47569 17.70481 16.91884 16.16716 16.78693
 [497] 17.26264 16.58866 15.87236 16.74118 17.21004 17.60702 16.14574 17.45618
 [505] 15.45438 16.83508 17.41440 17.29256 16.99985 16.17754 16.16926 17.16698
 [513] 17.31950 15.85966 16.85566 16.67159 16.84635 15.84262 15.91831 16.74595
 [521] 16.68016 16.70523 16.86365 16.44570 16.94236 16.92425 17.11221 15.89467
 [529] 16.85037 17.49086 16.68441 16.34394 17.21010 16.82981 15.86095 16.85721
 [537] 16.88988 17.12353 17.03401 16.65473 17.05932 17.12827 17.22815 16.67830
 [545] 16.88247 17.44021 16.42174 18.05187 17.01090 16.92066 16.34927 16.64515
 [553] 17.27052 16.75925 16.01724 17.30675 17.21511 16.82497 17.16034 16.73830
 [561] 17.68258 16.23067 17.03457 16.26209 16.57740 16.89472 16.62830 17.36408
 [569] 17.57887 17.08335 17.59276 17.17489 16.24146 16.20648 16.81551 16.61297
 [577] 17.25019 16.88230 17.05644 16.92605 17.36335 16.82407 16.10500 16.00510
 [585] 16.55019 15.99863 17.02721 17.25068 17.28039 16.44537 17.41633 16.52770
 [593] 16.90896 16.51966 16.83033 16.43212 16.98141 16.75303 16.51524 17.04739
 [601] 16.28092 16.30280 16.18539 17.67889 16.18995 17.49105 16.81118 16.77694
 [609] 16.86362 16.32696 17.24665 16.73026 17.26363 16.88233 17.23562 16.21596
 [617] 17.74984 16.71512 17.16604 16.64199 16.09664 16.16906 16.90187 16.97685
 [625] 17.15178 16.54976 16.97483 17.57633 17.63707 17.29575 16.62004 16.26821
 [633] 16.90048 16.46858 16.53488 16.88303 16.33543 16.65519 15.91121 17.37419
 [641] 16.54871 17.20405 15.72540 17.37923 16.66641 17.73343 16.80069 17.23884
 [649] 17.68914 16.54335 17.35171 17.36745 16.55015 16.52218 16.31097 16.54047
 [657] 17.01477 17.47476 16.66523 17.64044 17.43188 16.80426 16.95017 17.25578
 [665] 16.30647 15.92574 17.44893 16.24756 16.63328 16.97350 16.51281 15.91377
 [673] 16.28478 16.51554 16.60869 16.12136 16.95053 16.36684 17.01395 16.58090
 [681] 16.67980 16.79415 17.66977 17.39026 16.60184 16.33658 16.69864 16.61545
 [689] 16.50232 16.53048 16.42172 17.42225 16.87931 17.12594 16.45281 16.86652
 [697] 16.89665 16.48098 16.46897 17.40239 16.89106 15.96213 17.16439 17.52855
 [705] 16.48958 17.06655 17.13329 17.28739 16.61747 16.74063 16.48780 16.72196
 [713] 15.67096 16.96464 17.95920 17.77948 17.20162 16.57102 16.51679 16.73687
 [721] 16.52979 16.73184 17.03052 17.06595 16.60853 16.63777 17.37707 17.10643
 [729] 16.67024 16.22050 16.75423 17.40094 17.31104 16.88108 17.06061 16.51256
 [737] 16.15491 16.32424 16.93654 16.34676 16.30064 16.89027 16.71193 16.72260
 [745] 15.76473 16.82838 17.42521 17.01781 16.10249 16.78741 16.54860 17.32025
 [753] 16.70538 16.45798 16.76205 17.63836 16.46850 16.88435 16.95354 16.76717
 [761] 17.16329 17.19789 17.41806 16.81407 17.26117 16.95764 17.16776 16.45423
 [769] 16.96624 16.68892 16.60894 16.50173 18.01009 17.35865 16.75619 16.77393
 [777] 17.51683 18.10540 17.06483 16.67858 16.77933 17.31615 16.84467 16.45502
 [785] 15.92468 16.31591 17.10925 16.45453 16.29809 16.54940 16.73518 16.59128
 [793] 16.05851 17.33279 16.91966 16.81324 16.73489 16.29195 15.97639 17.20638
 [801] 16.74621 16.84711 16.03217 16.68859 15.60375 17.29094 15.90575 16.92184
 [809] 17.63195 16.44975 16.39110 17.81167 17.95380 16.28888 16.79507 17.20125
 [817] 17.70115 16.42255 16.05503 17.10535 16.94205 16.99315 16.70561 16.76432
 [825] 16.91083 16.75844 16.88353 17.10415 17.02177 17.12964 16.20754 17.30404
 [833] 16.70336 16.76151 16.27224 16.18749 16.40985 16.31122 16.72563 16.72632
 [841] 16.87992 16.04856 16.24297 17.00100 16.48811 16.54128 16.29181 16.58835
 [849] 16.54464 17.06069 16.62673 16.79306 16.11072 16.53187 16.26863 16.75475
 [857] 15.63740 17.36190 17.30887 17.63359 17.31561 16.74851 17.97567 16.15102
 [865] 16.88766 16.35937 17.17841 16.50045 16.46879 17.05660 17.73220 16.68742
 [873] 16.99721 17.45652 16.07807 17.27749 16.67581 17.21957 17.05854 16.91974
 [881] 17.00868 16.84926 16.91927 16.25051 16.19571 17.26171 16.27868 16.95169
 [889] 17.49690 16.43109 17.50804 16.98057 16.69267 16.67760 16.48284 16.94106
 [897] 17.13138 16.92612 16.75502 17.03534 15.51020 16.37590 16.50584 16.66183
 [905] 16.49753 16.82960 15.42539 16.23457 17.28727 15.95610 17.11997 17.22106
 [913] 16.57169 17.78232 16.75053 17.16121 15.96613 16.46361 17.29043 15.83573
 [921] 15.95731 16.76620 16.39871 16.64773 17.43062 16.17167 17.22745 16.95708
 [929] 17.08048 16.99795 16.56256 16.75174 16.60244 16.45106 16.76731 17.62834
 [937] 18.04985 17.53545 16.81717 16.36532 16.27106 17.09588 17.39697 16.96087
 [945] 15.88486 17.37636 17.69110 17.27469 16.01038 16.06225 17.15042 16.47281
 [953] 16.82237 17.01921 16.29794 17.33601 16.02642 16.06303 16.67332 17.37899
 [961] 17.72199 17.34629 16.00766 16.88426 16.05943 17.61250 16.84538 16.93341
 [969] 16.12361 16.80899 17.14116 16.56171 17.19012 16.39437 16.69622 15.84463
 [977] 15.63147 17.22742 16.72179 16.11336 17.88273 17.78646 16.16507 15.73022
 [985] 17.61583 16.63024 16.92645 15.98756 16.89703 16.94030 16.26070 16.47421
 [993] 16.23561 16.86041 16.26407 17.02365 17.27261 17.19724 16.17817 16.38339

$boot_sds
   [1] 6.056741 5.213747 5.902476 7.169889 4.760362 6.068524 6.081015 5.119545
   [9] 4.927697 5.569590 5.426484 6.170699 5.639139 4.974583 4.322502 4.957281
  [17] 5.195258 5.958553 5.447704 5.293951 5.052861 5.267866 5.388314 5.857193
  [25] 5.256467 6.127236 5.463299 4.911669 4.640675 5.296148 5.590095 6.806176
  [33] 5.203736 5.412370 6.568382 4.110142 5.195231 4.709093 5.122890 5.417854
  [41] 4.816023 4.651345 5.241922 5.801091 5.554613 5.978516 6.504411 5.368832
  [49] 6.170706 5.611463 5.085125 5.874528 5.685271 5.326262 6.444264 6.289633
  [57] 5.857746 4.981622 4.831596 5.920813 5.973513 5.887680 6.239226 5.043959
  [65] 6.764114 5.783540 6.305668 5.145124 4.950898 4.766705 5.492023 5.804073
  [73] 5.796790 4.823568 5.363788 5.172880 5.353465 5.656737 4.853553 5.374593
  [81] 4.752940 5.865755 4.728040 5.689990 5.119064 5.102319 5.305740 5.699346
  [89] 5.241966 5.082082 5.250624 5.616849 5.411459 5.948924 5.462404 5.591316
  [97] 6.932250 5.505007 5.947980 5.977642 6.055582 5.663435 4.965966 5.743761
 [105] 5.681822 5.259006 5.279769 5.546363 5.857552 5.509247 4.577881 5.111263
 [113] 5.417195 5.467720 6.291290 6.449037 5.432694 5.581010 5.211197 5.457356
 [121] 4.925238 5.891856 5.448168 6.465838 6.211603 5.321370 5.316371 5.530511
 [129] 5.455778 5.758156 5.892604 5.845697 5.993668 5.969961 4.786535 6.442191
 [137] 4.890682 4.982662 5.989926 5.322238 5.363692 4.504860 5.361399 6.233237
 [145] 5.635964 4.912339 5.045124 5.188588 5.508130 6.756996 5.443810 5.018430
 [153] 5.753702 6.017025 5.191607 4.806607 6.111525 4.943212 4.915038 6.405865
 [161] 5.007161 5.378051 5.664393 4.380043 4.705554 5.131152 5.599748 5.427096
 [169] 6.357610 5.741957 6.324994 5.046972 5.210314 5.101075 5.793980 4.985792
 [177] 5.656340 5.754991 5.306868 5.697950 5.084930 5.109784 5.463584 5.737425
 [185] 5.356641 4.873075 6.326409 3.589852 5.034065 5.510263 6.529939 5.791265
 [193] 5.047304 5.213920 5.945043 4.266233 5.147504 5.387380 3.757362 5.573362
 [201] 5.788395 5.039780 5.098705 5.775296 5.802627 5.749238 5.551491 5.965704
 [209] 4.937594 4.745325 5.535876 5.601711 5.804621 5.629498 4.799867 6.163589
 [217] 5.565544 5.167937 6.435729 4.974566 5.162915 5.595978 5.415268 5.999200
 [225] 6.467648 6.369713 6.081447 4.858463 5.890976 6.612484 5.146275 5.226877
 [233] 5.142785 6.070448 5.820696 5.109648 5.425036 5.566726 5.725683 6.123589
 [241] 5.183558 5.301968 5.374230 5.714335 5.480546 4.796982 4.942470 5.397422
 [249] 4.904661 5.093931 4.925380 6.355419 6.529766 4.975264 5.326649 5.272093
 [257] 5.400537 6.071203 5.004830 4.448178 5.819002 5.994743 4.951246 5.845142
 [265] 4.781654 5.134423 5.959175 4.354360 4.977988 5.966635 5.654619 5.168192
 [273] 6.314548 4.514891 5.009464 4.636870 5.416897 5.324284 5.811136 5.876990
 [281] 5.230589 6.056841 5.092891 6.334339 5.249366 4.913469 5.320937 6.366168
 [289] 5.656229 5.743542 5.171785 4.901684 4.858967 6.242310 5.126084 6.148678
 [297] 5.842866 5.010516 4.910833 4.879856 4.809715 4.563049 6.006769 6.302921
 [305] 5.081469 4.951517 5.607203 5.361945 6.267967 5.660513 6.249634 4.764647
 [313] 5.201280 5.021209 5.004246 5.781393 5.154447 5.592961 5.572255 4.909260
 [321] 5.581487 4.742172 4.708312 5.301561 5.251651 5.807659 4.907961 4.612651
 [329] 5.101010 5.379095 6.350659 5.302956 5.527672 4.882308 5.310570 5.049866
 [337] 6.506573 5.070533 4.993233 5.849624 5.075301 4.727037 5.064095 6.046110
 [345] 6.067721 5.825397 4.950972 4.855466 5.340220 5.226282 4.858584 5.388112
 [353] 5.598678 4.375292 5.984622 5.458428 5.484467 6.839842 6.319415 4.893833
 [361] 5.940524 5.311512 6.015898 5.118725 5.670243 5.479731 6.268903 4.821310
 [369] 5.511695 5.275749 5.657222 4.788396 5.565805 4.997382 4.477941 4.115370
 [377] 5.095312 4.860635 4.909603 5.770317 5.261597 6.104451 5.748543 5.732272
 [385] 4.978129 5.602711 4.834684 5.427356 5.874491 4.538906 5.065238 5.314658
 [393] 5.796301 5.998860 5.966505 5.149422 5.713563 5.459656 7.004569 4.748827
 [401] 6.073852 5.800947 6.319809 5.401842 5.477487 6.437539 4.433041 6.342293
 [409] 5.712900 6.577496 4.544939 5.700422 5.016599 5.457674 4.801518 5.452891
 [417] 5.130541 4.854769 5.431223 5.727219 5.151599 4.952250 5.184223 4.644023
 [425] 6.122185 5.975738 4.646833 5.654675 5.050837 4.730337 5.064245 6.020249
 [433] 4.339115 4.628110 4.894016 4.945575 6.077845 5.907718 5.438279 5.158604
 [441] 5.693941 6.993993 5.610139 5.933818 4.579090 5.148970 5.472676 4.522705
 [449] 5.076979 4.468243 5.536490 5.277609 6.146037 5.075150 5.166651 4.477236
 [457] 5.450151 6.145710 5.259955 5.713303 5.746360 5.941317 5.389201 4.947068
 [465] 4.343878 6.000846 5.328782 6.484484 5.862195 4.940557 5.055302 6.324059
 [473] 5.860013 5.620876 5.146650 4.779215 5.324630 5.109189 5.343300 5.743748
 [481] 5.495191 5.915198 5.327855 4.702432 5.614464 5.586267 5.280658 4.425061
 [489] 5.668272 5.491833 6.400497 4.830851 6.524642 5.431593 4.959592 4.539267
 [497] 5.786475 5.033967 4.659342 5.204812 5.279754 5.372472 4.919677 5.100160
 [505] 4.714135 5.635332 6.638590 5.537651 5.755955 4.633317 5.506918 5.342096
 [513] 5.307616 4.450802 5.277366 5.145560 5.889413 4.277152 4.964935 5.850624
 [521] 5.996680 5.443877 5.462540 5.145452 5.471913 4.341219 3.970597 4.670697
 [529] 5.184864 5.791498 5.666697 4.945126 5.191879 5.152184 4.981145 5.559733
 [537] 5.046329 5.708033 5.603743 5.097890 5.513832 5.692131 5.808534 5.093389
 [545] 5.416598 5.926895 6.324187 6.380100 5.400291 4.765430 4.031235 5.045223
 [553] 5.917768 5.531825 5.363569 6.185663 6.053648 4.898830 5.010852 5.261617
 [561] 5.075454 5.470097 6.195921 5.363234 5.199629 5.875579 5.125680 6.302583
 [569] 5.679879 4.765348 6.933633 5.481037 5.185202 5.400636 5.159915 5.264336
 [577] 6.193163 5.403461 5.166113 5.939919 5.583905 5.287200 3.981610 4.786695
 [585] 4.852031 5.370548 6.384227 6.122689 5.575492 5.174506 5.223361 4.940634
 [593] 5.569172 4.731739 5.005344 4.864539 5.459836 5.047756 5.971062 5.622524
 [601] 4.840468 5.339127 4.443515 6.355575 5.397552 5.945264 5.543151 5.002016
 [609] 5.547799 5.865403 5.860633 5.408968 6.012204 5.449423 5.618880 5.197064
 [617] 6.062908 5.624336 5.651875 5.292816 4.458503 5.037801 5.419747 5.492930
 [625] 5.625775 5.406194 5.658574 6.450689 6.469434 5.549169 6.101378 4.540134
 [633] 5.259111 5.025476 5.233151 5.127815 4.603570 4.817447 4.495751 5.780170
 [641] 5.451868 5.751063 4.203112 5.427740 6.417331 5.777402 4.364933 5.958015
 [649] 5.746141 5.786433 5.323809 5.979053 4.678767 4.820718 4.981232 4.256734
 [657] 4.849054 5.286219 4.998647 6.124437 4.803946 4.854828 6.558722 5.553511
 [665] 5.629764 4.384870 5.581445 5.591875 5.160486 5.444284 4.943310 5.270554
 [673] 4.990208 4.956123 5.064318 4.806967 5.749104 4.566069 5.398893 4.558318
 [681] 5.598853 4.444345 7.174437 5.701133 5.380573 4.934336 5.407648 5.316219
 [689] 5.382025 5.302965 4.394075 5.354918 6.793008 5.467426 4.717913 5.968466
 [697] 5.603292 4.996312 4.938925 4.573071 5.137026 4.528046 6.045621 5.863035
 [705] 5.218186 5.229258 5.950811 6.283306 5.044920 5.177027 5.277721 4.859208
 [713] 4.351867 5.416365 5.828464 6.619745 5.745728 5.069754 4.745913 4.985595
 [721] 4.456818 5.200976 5.880361 4.980410 4.987664 5.909517 5.617092 5.622905
 [729] 6.075808 5.676389 5.321377 6.332320 6.018670 5.430506 5.749843 4.844204
 [737] 4.642405 4.963982 5.522285 5.925235 4.884240 5.276718 5.512968 5.814385
 [745] 5.126908 5.622638 6.219246 5.548099 5.725805 5.382226 5.710732 5.384670
 [753] 5.209543 5.264657 5.003350 6.239655 4.320836 5.010982 5.728807 5.228848
 [761] 5.351399 5.245250 5.585234 5.869449 5.149486 6.300101 5.315750 4.580842
 [769] 5.589779 5.271780 5.170633 5.098643 6.621591 4.846158 5.125283 5.863942
 [777] 6.316473 6.156023 6.043082 5.157973 5.589664 5.371213 5.399088 5.044246
 [785] 4.576846 4.995992 6.214560 4.891626 4.522202 4.858920 5.347669 5.643482
 [793] 5.384285 5.674924 5.700100 5.413747 3.789611 5.151326 5.292214 6.482386
 [801] 5.759514 4.779323 4.881720 5.982781 4.352779 5.372637 4.762687 5.491111
 [809] 5.468019 4.744731 4.236294 5.691425 5.756013 4.836807 6.221859 5.699388
 [817] 6.776164 4.955605 5.346409 6.181206 5.257216 6.296385 4.887499 5.392892
 [825] 4.709317 6.632168 4.703149 5.542346 5.882456 5.777275 4.621278 5.517518
 [833] 5.366177 5.051838 5.715080 4.932621 5.808006 4.721429 5.405572 5.017073
 [841] 5.310778 4.884083 3.954782 5.254395 4.933062 4.912252 5.266502 5.257018
 [849] 4.801459 4.708130 4.933793 5.676161 5.112535 4.679686 5.125262 5.882474
 [857] 4.653792 4.904053 5.718038 6.363428 5.381595 4.131815 6.069447 4.988944
 [865] 5.665226 4.681931 5.814061 5.454344 4.934491 5.028327 6.143784 5.286777
 [873] 5.340339 5.582643 5.210916 5.688855 5.568147 6.216612 5.355080 5.340671
 [881] 6.219361 4.893092 5.696389 5.719802 4.772792 5.775188 5.004185 5.887932
 [889] 5.473052 5.010622 5.596674 5.770195 4.522743 5.332102 5.210471 4.093167
 [897] 6.022440 5.999420 5.264710 5.802940 5.236029 5.180847 4.595033 4.986894
 [905] 5.335615 4.935902 4.950636 5.259564 5.608624 4.739127 4.756623 6.231335
 [913] 5.101330 6.306926 4.719972 5.349232 4.436680 5.478713 5.979127 4.802901
 [921] 4.720857 5.228361 5.623395 5.610893 5.963917 5.103616 4.946484 5.993472
 [929] 6.758515 6.426608 5.306143 4.375291 5.519104 5.390451 5.298465 5.146285
 [937] 7.083273 6.526111 5.896244 5.102745 5.233789 6.133870 5.659107 5.229765
 [945] 4.660460 6.176343 6.952063 5.613743 4.528696 5.084600 5.969682 5.653292
 [953] 5.301781 5.462190 5.846003 6.018024 4.235123 4.449262 5.393023 6.044202
 [961] 7.193472 5.647921 4.588331 6.301511 4.984883 6.060567 5.837099 5.372416
 [969] 5.848206 5.691978 5.602031 5.998913 5.543951 4.829520 5.591493 5.241383
 [977] 4.454995 5.059309 5.076342 4.527864 7.194828 6.543023 4.741713 4.564505
 [985] 5.405975 5.136176 5.650032 4.734949 4.942184 5.059526 4.852059 5.386645
 [993] 5.199604 5.830754 4.650790 5.485193 5.704031 5.670459 4.689619 4.807152</code></pre>
</div>
</div>
<p>The <em>estmeansd</em> library uses Box-Cox method for estimating mean and sd when the data available are the median, minimum and maximum values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>res_bc <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">min.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">max.val =</span> <span class="dv">42</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>res_bc </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$est.mean
[1] 16.69078

$est.sd
[1] 3.620106</code></pre>
</div>
</div>
<p>Again, the standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_SE</span>(res_bc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$est.se
[1] 0.3164941

$boot_means
   [1] 16.61950 16.60544 16.98685 16.37338 17.22550 16.53991 16.96921 16.42799
   [9] 16.79853 16.37300 16.46512 16.42107 16.76768 16.65161 16.88464 17.34063
  [17] 17.02428 16.67472 16.52115 16.49748 16.83511 16.03474 16.50927 16.41899
  [25] 17.19008 16.62758 16.56849 16.51621 16.59377 16.79799 17.15780 16.64888
  [33] 16.43999 16.43105 16.84439 17.09933 16.14720 17.10175 16.93661 16.83493
  [41] 17.19851 16.57157 16.91155 16.78373 16.58965 16.60323 16.46596 16.33361
  [49] 17.14390 16.92362 16.79613 16.52471 16.76237 17.10626 16.68339 16.74075
  [57] 16.82590 16.65960 16.89891 16.41728 16.93513 16.40843 16.56640 16.63776
  [65] 16.69542 16.73260 16.45204 17.02676 16.33247 17.38994 16.21774 16.60234
  [73] 17.10086 16.83138 16.17054 17.12027 16.96872 16.30576 17.47867 16.88597
  [81] 16.39533 16.22542 16.08966 16.12750 16.80409 16.50629 17.27337 16.80650
  [89] 16.65311 16.99611 16.91171 16.61373 16.92425 16.62230 17.06121 17.27548
  [97] 16.35929 16.54343 16.72730 17.25368 16.67899 16.26994 16.64170 16.08557
 [105] 16.64277 16.82771 16.88511 16.77592 16.95999 16.54840 16.30886 17.33406
 [113] 16.33664 16.68176 16.88799 17.37785 16.82170 17.05243 16.55098 17.07120
 [121] 16.67871 16.43541 16.76094 16.92627 16.56860 17.12882 16.84691 17.02399
 [129] 16.66598 16.58126 16.57442 16.39630 16.73956 16.37509 17.01046 16.55296
 [137] 17.41890 16.96223 17.09172 16.96084 17.04858 16.68308 16.58476 16.64310
 [145] 17.30123 16.85137 16.75863 16.40464 17.51963 17.02571 16.86999 16.38298
 [153] 16.37584 16.61673 16.82036 16.63085 16.68524 17.28534 16.39467 16.47194
 [161] 16.83710 16.40145 16.77101 16.87334 17.05066 16.94943 16.10628 16.20021
 [169] 16.82599 16.33404 17.26177 16.90358 17.21385 16.66521 17.48259 16.86498
 [177] 16.90133 16.56536 16.54127 16.82765 16.50710 16.52007 16.43771 16.56699
 [185] 16.68056 16.01148 16.63919 17.03173 16.53091 16.40270 16.52274 17.20118
 [193] 17.03042 17.24418 16.71294 17.72162 16.73555 17.05308 16.95042 16.66948
 [201] 16.26383 16.86109 16.49322 16.05457 16.43777 17.13530 16.21572 17.11896
 [209] 16.12419 16.58550 16.54040 17.25704 16.67401 16.64811 17.22129 17.00765
 [217] 16.06591 16.73037 16.74179 17.03578 16.39595 16.91102 16.18880 17.42751
 [225] 17.03672 16.83501 16.20934 16.21074 16.86764 16.20755 16.56512 16.68130
 [233] 17.42064 16.55432 16.22931 16.56924 16.88691 16.54002 16.27785 16.48836
 [241] 17.03065 16.59928 16.90509 16.73666 17.01153 16.89132 16.85471 16.83844
 [249] 16.24568 16.78431 16.40237 16.68383 16.71415 16.54202 16.53638 16.97315
 [257] 16.87934 16.89119 16.64040 16.42743 16.85487 16.46166 16.82064 17.06939
 [265] 16.52190 16.83825 16.27107 16.85880 17.42329 16.84253 16.46431 16.92531
 [273] 16.83389 16.50754 16.34825 16.95428 16.11012 16.47015 16.44144 16.69954
 [281] 16.76518 16.32170 16.71646 16.54629 16.55674 16.97551 16.49697 16.70925
 [289] 17.05182 16.44889 16.83577 16.99714 16.25566 16.49456 16.54652 16.80030
 [297] 17.04938 16.56339 17.21699 16.73682 17.08203 17.27258 16.55013 16.82122
 [305] 16.60070 16.67442 16.55545 16.34687 16.91974 16.54617 16.48286 16.60606
 [313] 17.03701 16.84527 16.22599 16.98578 16.85766 17.02041 16.78629 16.49124
 [321] 17.30150 16.72716 16.96854 16.86865 17.25556 17.32631 16.27701 16.74731
 [329] 16.81829 16.69730 16.65410 16.65969 17.08980 16.54420 16.64776 16.57611
 [337] 16.17574 16.30874 16.81722 16.44820 16.38684 16.94403 16.68352 17.39357
 [345] 17.01459 16.66292 17.26149 16.41535 16.29033 16.73009 16.58478 16.57832
 [353] 16.88417 16.46951 16.36591 16.67283 16.87873 17.06480 16.58238 16.46304
 [361] 16.95326 16.37672 16.80326 16.17370 16.30970 16.84445 16.41480 16.82225
 [369] 17.19023 16.72907 17.05970 17.29891 16.50281 16.42930 16.63923 17.07283
 [377] 16.36992 16.41310 16.33938 17.33010 16.48198 16.50842 16.63009 16.60705
 [385] 17.05950 16.97054 16.64788 16.78220 16.93595 17.22851 16.48305 16.38487
 [393] 16.74940 17.55224 16.65947 17.36554 16.21457 16.17941 16.62049 16.49673
 [401] 16.74443 17.01362 16.68746 16.85938 16.80883 16.51906 16.20755 16.69993
 [409] 16.87220 17.06124 16.72650 16.51577 16.74351 16.93603 16.94076 16.81912
 [417] 17.13793 17.09238 16.51380 17.54956 17.16610 16.76158 16.68052 16.75421
 [425] 17.21187 16.43488 17.29382 16.18978 16.68206 16.80612 16.48610 17.01557
 [433] 16.94644 16.62436 16.61528 16.37404 17.23983 16.70706 17.05811 17.14014
 [441] 16.56248 16.40032 16.67330 16.67429 16.47447 16.55634 16.95253 16.32640
 [449] 16.69114 16.95695 16.22040 16.66036 16.48263 16.58726 16.77656 16.69457
 [457] 16.32322 17.03014 16.60256 16.96545 16.59547 16.40034 16.68862 16.03295
 [465] 16.79791 16.75250 16.51765 16.59963 16.60963 17.04489 16.61483 16.29046
 [473] 16.82328 16.14801 16.85790 16.49270 16.80258 16.64292 16.67670 16.61538
 [481] 16.57359 16.14067 16.58160 17.17841 16.65093 16.42826 16.65278 16.65886
 [489] 16.44028 17.31336 16.57838 17.51378 16.79215 16.55075 16.28995 16.52784
 [497] 16.67763 17.50877 16.34263 16.74621 16.51012 16.81807 16.72354 17.08604
 [505] 16.75039 16.55804 16.43936 17.36826 16.62960 16.78908 17.00681 16.53221
 [513] 16.53602 16.47194 16.80416 16.80880 16.41508 17.04593 16.71024 16.39722
 [521] 16.75359 16.39501 16.88696 17.47570 16.85410 16.50587 16.65014 16.63170
 [529] 16.09438 17.04715 16.52366 17.26250 17.47242 17.21561 17.10624 16.89520
 [537] 16.46606 17.47512 16.47407 17.65114 16.96732 16.75003 16.65209 16.58658
 [545] 16.50700 16.44418 16.92918 16.69860 16.48330 16.48420 16.13814 16.75481
 [553] 17.08138 16.91870 16.37350 16.50524 16.66543 16.55565 16.74338 16.66825
 [561] 16.75924 17.23691 16.81857 16.47850 16.82323 16.75203 16.29340 17.30413
 [569] 17.17691 16.48172 16.81652 16.77127 17.12834 17.21529 16.50047 16.67687
 [577] 16.87494 16.41677 16.84109 16.36865 16.51482 16.61041 16.10348 16.77398
 [585] 16.52074 16.97745 17.27354 16.22663 16.84522 16.72585 16.81132 16.59795
 [593] 16.73640 16.81020 16.77819 16.12285 17.25710 17.01036 16.76438 16.87732
 [601] 16.10096 16.38565 17.04781 16.65993 16.50016 16.37622 16.35879 16.51746
 [609] 16.49357 16.60857 16.80879 16.98623 17.43997 16.78724 16.97825 16.50019
 [617] 16.76250 16.78444 16.36914 17.29075 16.97211 16.83616 16.93855 17.20322
 [625] 16.61122 17.06972 16.89402 16.51288 16.71093 17.19952 16.47954 16.75162
 [633] 16.10625 16.90353 17.08770 16.71976 16.53918 17.08954 16.90385 16.91872
 [641] 16.39442 17.52879 16.97059 17.28404 17.12898 16.15378 17.03340 17.17341
 [649] 16.52632 17.16493 16.49777 16.57337 17.11456 16.49804 16.32792 17.28744
 [657] 16.47844 16.35964 16.42806 16.81276 16.60159 16.47683 16.71923 16.19262
 [665] 16.92719 16.51524 16.49262 16.97231 16.54042 16.65453 16.62713 16.99949
 [673] 17.21557 17.09659 16.87726 16.40236 16.67506 16.57430 17.09593 16.51877
 [681] 16.72056 16.16768 16.46834 16.16631 16.73705 16.75070 16.74823 16.37228
 [689] 16.59116 17.18745 16.51885 16.69063 16.67391 16.16896 16.77256 17.19292
 [697] 16.79256 16.24422 16.77800 16.67037 16.55864 16.83749 16.42525 16.59487
 [705] 16.25174 17.07039 16.78256 16.84201 16.33419 17.01221 16.17462 17.17810
 [713] 16.74995 16.82128 16.76198 16.13914 17.11144 16.57436 16.15232 16.37852
 [721] 17.16330 16.44211 16.78330 17.09387 16.86543 16.51587 16.29547 17.08486
 [729] 16.51237 16.31340 16.94488 16.96698 16.49482 16.68760 17.09166 16.60710
 [737] 16.53902 16.42624 16.86328 16.30312 16.77689 16.30885 16.65821 16.47750
 [745] 16.54440 16.94809 17.21016 16.91629 16.54562 16.84132 16.64041 16.72993
 [753] 16.60372 17.00476 16.65480 17.48636 16.51751 16.88196 16.55344 16.98828
 [761] 17.14319 16.08553 16.49946 16.51281 16.37175 16.68992 16.96466 16.80831
 [769] 16.57881 17.22682 16.58003 17.13212 16.11346 16.77800 16.05977 16.83242
 [777] 16.63620 16.63004 16.97802 17.16623 17.11861 16.83805 16.96473 16.40651
 [785] 16.87848 16.57562 16.37510 16.69987 16.94361 17.17232 16.82531 17.09458
 [793] 16.38501 16.08604 17.10672 16.71201 16.67890 16.85420 16.24225 17.18386
 [801] 17.04548 16.79798 17.61376 16.79327 16.82701 16.79519 17.63664 16.62258
 [809] 16.91168 16.90401 16.87316 16.39112 17.06192 16.06099 16.70497 16.37914
 [817] 16.76816 16.59657 16.80608 16.63386 16.82624 16.71995 16.81858 16.19230
 [825] 16.47479 16.99393 16.69931 16.51724 16.83309 16.59971 16.89626 16.81529
 [833] 17.05585 16.77545 16.98455 16.20689 17.31505 16.93538 17.35084 16.71029
 [841] 16.98070 16.60873 16.69574 17.05444 16.51899 17.08946 16.80817 16.18638
 [849] 16.83056 16.58756 16.55804 16.65416 16.16510 16.21905 16.30346 16.79421
 [857] 17.06097 16.77545 16.37005 16.91545 16.95483 17.09106 17.05118 17.03768
 [865] 16.78552 16.11071 16.80426 16.43478 16.41446 16.70347 16.46562 16.76923
 [873] 17.13539 16.79552 16.56757 16.36508 16.60601 16.19475 16.78140 17.16741
 [881] 16.39884 16.92804 17.35341 16.78923 16.37767 16.76492 16.86671 16.51310
 [889] 17.10594 16.72310 16.75434 16.48316 16.34593 16.41818 16.90155 16.98137
 [897] 16.61488 16.47240 16.88310 17.06982 16.60667 16.70527 16.83325 16.66075
 [905] 16.26776 16.83576 16.40616 16.59572 16.83047 16.44360 16.80922 16.74596
 [913] 16.80258 17.17521 16.95385 16.82365 16.51872 17.01162 16.86432 16.93391
 [921] 17.12149 17.06600 16.62506 16.60597 16.83995 16.67435 16.77695 16.63273
 [929] 16.63247 16.83365 16.45602 16.61998 16.19925 16.94297 16.78096 17.44446
 [937] 17.03420 16.74712 16.48054 17.02195 16.23214 16.74617 16.74238 16.93085
 [945] 16.38729 17.42168 16.62369 16.26301 17.42470 16.63969 17.40098 16.11769
 [953] 16.36656 17.17702 17.14599 16.39195 16.27929 16.75580 16.69729 16.44340
 [961] 17.07319 16.76360 16.25003 16.63445 17.37516 16.96659 16.39822 16.46239
 [969] 16.87120 16.95558 16.60808 17.56040 16.78276 16.40824 17.02433 16.40897
 [977] 16.98582 17.18296 16.50015 16.63085 16.99670 16.14841 17.16677 16.58928
 [985] 17.31038 17.01654 16.47989 16.13499 16.95507 16.58247 16.60206 17.05872
 [993] 16.67785 16.63747 16.80655 16.97838 16.70177 16.34688 17.06286 16.46086

$boot_sds
   [1] 3.359512 3.040868 3.462556 3.104239 3.876423 3.592225 3.386621 3.085985
   [9] 3.727133 3.720339 3.575315 3.397902 2.982521 3.046177 3.292880 4.114856
  [17] 3.127077 3.930764 3.441695 3.146310 3.828936 3.402520 3.449742 4.209891
  [25] 3.849349 3.097083 3.128389 3.663157 3.087440 3.342224 3.999224 3.647124
  [33] 3.473777 3.583949 3.389349 3.464283 3.133440 4.654132 3.791236 3.586116
  [41] 4.065361 3.231420 3.650451 4.241677 3.339990 3.513514 4.027122 3.338277
  [49] 3.081157 4.141428 3.521367 3.606528 3.367824 3.436759 3.836010 3.833287
  [57] 3.502881 3.303778 3.227869 3.437878 3.471454 3.556926 3.512129 3.543159
  [65] 3.199027 3.895358 4.028302 3.597079 2.988051 4.673688 3.342388 3.133444
  [73] 4.439630 3.087020 3.184433 3.436478 3.101436 3.281487 4.317846 3.494574
  [81] 2.975399 3.432809 3.186014 3.294233 2.982423 3.411344 3.305671 3.247563
  [89] 3.540794 4.341951 3.121772 3.838589 3.596128 3.030218 3.170706 3.739614
  [97] 3.376947 3.849478 3.850850 3.557545 4.003960 3.423089 3.926333 3.109470
 [105] 3.518802 3.772823 3.572237 3.412155 3.110599 3.197192 2.758756 3.631654
 [113] 3.418579 3.431561 3.273387 3.809467 3.856216 3.338645 2.918216 4.040096
 [121] 3.538572 3.598832 3.909049 3.427526 3.694060 2.892438 2.880896 3.332710
 [129] 3.267297 3.514022 3.534868 3.317010 3.518988 2.965998 3.223820 3.619296
 [137] 4.032751 3.481499 4.369444 3.252557 3.865549 3.153899 3.773947 2.916339
 [145] 3.363224 3.200528 3.380630 3.464204 4.344313 2.838770 3.534867 3.246998
 [153] 3.564789 3.121635 3.330866 3.509488 3.110390 3.300173 3.703586 3.397200
 [161] 3.864412 3.105346 4.415797 3.059690 3.901487 4.235145 2.574929 2.996730
 [169] 3.765193 3.313775 3.761127 3.172749 3.192972 3.597856 3.736988 3.987327
 [177] 3.913627 3.662701 3.424988 3.271884 3.311052 3.464858 3.536167 3.826471
 [185] 3.457091 2.965435 4.061428 3.922787 3.886334 3.250803 3.085545 3.986150
 [193] 3.583137 3.394111 2.983255 4.608490 3.719781 3.512695 3.606682 3.824318
 [201] 3.480786 3.470998 3.832538 3.488885 2.872989 4.019750 3.459952 3.914302
 [209] 3.625603 3.800077 3.617080 3.815142 2.917614 3.531303 4.221237 4.076579
 [217] 3.208644 3.762085 3.018554 3.675838 3.209927 3.725472 3.324037 3.213128
 [225] 3.450567 3.465805 3.106620 3.993073 3.398860 3.003784 2.930525 3.189928
 [233] 3.523248 3.398149 3.646227 3.768362 3.799771 2.973070 3.111828 3.224097
 [241] 4.637024 3.312187 3.021133 3.491375 3.803699 3.564044 3.066595 4.139760
 [249] 3.681278 3.175941 3.125857 4.190176 3.487544 3.030583 3.427032 3.728431
 [257] 3.231946 3.680510 3.916988 2.959757 3.585928 2.984442 3.661827 3.934464
 [265] 2.873875 3.516144 3.646066 4.147384 3.397698 3.988779 3.878010 3.212551
 [273] 3.655440 3.244604 3.584199 3.762365 3.270253 4.122492 2.897959 3.570981
 [281] 3.331907 3.172335 3.046108 3.844860 3.387932 3.476016 3.322099 3.609761
 [289] 3.173990 3.505029 3.212564 3.570269 2.974546 2.951509 3.951655 2.810755
 [297] 3.393132 3.745622 4.558847 3.493160 3.704375 3.296983 3.130915 3.105294
 [305] 3.250690 3.523195 5.214903 3.878867 3.458924 3.108578 3.043845 3.455394
 [313] 3.717549 3.641197 3.386021 2.972983 3.335146 4.968917 3.872369 3.590170
 [321] 3.926012 3.726851 3.249402 3.331239 4.565762 4.319867 2.889038 3.370722
 [329] 3.734241 3.124420 3.363353 4.576976 3.947433 3.051844 3.032660 3.212016
 [337] 3.328143 3.533983 4.129816 3.650796 3.417366 3.402936 3.154091 4.037794
 [345] 3.780002 3.660537 3.578824 3.873645 3.397929 3.087632 3.854529 3.334795
 [353] 3.602339 3.713030 3.255074 3.007591 3.262524 3.265733 3.723888 3.270590
 [361] 3.278843 3.495700 3.294747 3.185054 3.139003 3.158570 3.169987 3.346556
 [369] 3.371347 4.025090 3.278166 3.515802 3.044396 2.849783 3.901247 4.114475
 [377] 3.206502 4.016281 2.786404 3.904362 3.324364 2.846576 3.486459 3.989800
 [385] 3.752945 3.623547 3.367436 3.646172 4.080464 3.639196 3.970243 3.123117
 [393] 3.578421 4.117916 3.579293 4.135139 3.584619 3.188931 4.273832 2.863964
 [401] 3.678275 3.966714 3.408234 3.634607 3.719216 3.446407 3.642701 3.455120
 [409] 3.315363 3.770770 3.437189 3.421616 3.602692 3.354293 3.747534 3.529308
 [417] 3.297980 4.023264 3.712733 4.352552 3.367661 3.486326 3.118399 3.650840
 [425] 4.414124 3.570202 4.209663 2.969094 3.798286 4.114198 3.260321 3.891911
 [433] 3.232976 2.898695 3.558132 3.041480 3.850465 3.975216 4.070209 3.282120
 [441] 3.409057 3.228269 3.050020 3.001906 3.723391 3.412722 3.558188 3.520703
 [449] 2.909927 3.691195 2.885600 3.947514 2.811257 4.165738 3.484141 3.676974
 [457] 3.045785 3.632209 2.906327 3.235873 3.573705 3.020128 3.325559 3.344297
 [465] 3.404968 3.882903 3.368968 3.648994 3.842286 3.828935 3.112457 3.388627
 [473] 3.284112 2.966155 2.978417 3.253405 2.977951 5.001792 3.524653 3.788371
 [481] 3.206517 3.286890 3.698876 3.721897 3.425936 3.720272 2.844903 3.794871
 [489] 3.363760 4.176133 3.506771 4.835397 3.317035 3.627389 3.994385 3.552659
 [497] 3.683888 4.328764 3.488215 3.755673 3.549893 2.980475 3.285548 3.748840
 [505] 3.477916 3.411501 3.701782 4.324272 3.374821 3.695123 4.190869 3.974619
 [513] 3.662039 4.090460 3.453125 3.368915 3.250412 3.968169 3.886343 3.475103
 [521] 3.439855 2.754528 3.597039 3.542604 3.257713 3.017359 3.188577 3.685025
 [529] 3.272770 3.755863 4.142742 3.336188 3.985684 3.168663 3.866276 4.714214
 [537] 3.136756 4.224437 3.085171 4.064979 4.335398 3.437602 3.136517 3.112040
 [545] 3.617250 3.588404 3.525572 3.420767 4.142380 3.735685 3.676870 3.109483
 [553] 3.728542 3.875168 3.487259 3.757423 4.320250 3.347897 3.403853 3.772583
 [561] 3.277511 3.952613 2.857228 2.997356 4.200886 4.048865 2.857518 4.305748
 [569] 3.359204 2.966107 4.039403 3.212999 3.215278 4.225138 3.661079 3.289208
 [577] 3.119902 3.063754 3.643251 2.915776 3.201957 3.194348 3.487027 2.857098
 [585] 3.316864 3.688776 3.886815 3.757405 3.663038 3.313268 3.365528 3.349293
 [593] 3.799039 3.211985 4.095726 3.491005 4.196924 3.622085 3.725931 3.759641
 [601] 4.077927 3.255892 3.645800 3.446074 3.622835 2.718157 2.955445 3.076012
 [609] 4.034121 3.178412 3.047648 3.323422 3.941636 3.289397 3.268784 3.924884
 [617] 3.180802 3.242838 3.587265 3.869167 3.658008 4.437133 3.895678 2.996989
 [625] 3.404747 3.234257 3.617072 3.799840 3.708462 4.025645 3.054681 4.665679
 [633] 3.543621 3.252473 4.192278 3.387885 3.284834 3.210602 3.543806 3.766633
 [641] 3.301956 4.204492 3.598269 4.167169 4.194233 4.120629 4.244400 3.966151
 [649] 4.240218 3.683100 4.127516 4.039347 3.631923 3.503221 3.618727 3.981776
 [657] 3.126216 3.763566 3.407495 3.301878 3.542653 3.775649 2.845045 3.491737
 [665] 3.335352 3.303095 3.755053 3.308014 3.706475 3.754518 3.204945 3.404913
 [673] 3.726455 3.329033 3.777579 3.482479 3.341445 3.579939 3.900476 3.254276
 [681] 3.314034 2.848357 3.289856 3.511448 3.365672 3.533281 3.371031 3.035289
 [689] 3.257777 4.057384 3.445213 3.624895 3.370395 3.498568 3.294900 4.324975
 [697] 3.154534 3.046266 3.822989 3.454533 3.183511 3.201773 2.994873 2.898273
 [705] 3.262474 3.482685 4.310450 3.527498 3.485117 4.162948 2.870251 3.639222
 [713] 3.346777 4.060885 3.202220 3.412030 3.819132 3.750381 3.130447 2.705698
 [721] 4.203004 3.099716 3.069005 3.605579 3.033768 3.921071 3.670618 3.387079
 [729] 3.675829 3.196812 3.450501 3.615062 3.832763 3.028520 3.148363 3.090168
 [737] 3.906733 3.645993 3.476494 3.685877 3.847078 3.099888 2.801615 3.366746
 [745] 3.770612 3.658273 3.899856 3.196684 2.949192 3.601828 3.515017 3.954447
 [753] 3.385995 3.480730 4.637983 3.893102 3.647796 3.478507 4.161493 3.401141
 [761] 3.160276 3.289747 3.050591 3.288162 3.542769 3.397243 4.112850 3.210029
 [769] 2.880816 3.590616 3.847930 3.428742 3.505731 3.630716 3.584076 3.977790
 [777] 3.304504 3.420578 3.505325 3.801741 3.318873 3.826561 3.504000 3.748521
 [785] 3.593495 3.780877 3.117464 3.788668 3.919304 3.577802 3.491560 4.665466
 [793] 3.138530 3.644990 4.100921 3.392486 2.891639 3.746481 2.837888 3.748914
 [801] 3.056702 2.928692 4.437132 3.981866 4.014172 3.213803 4.247183 4.026047
 [809] 3.835835 3.753461 3.012614 3.460519 4.534813 3.765488 3.142675 3.818762
 [817] 3.084087 3.179751 3.561294 3.333091 3.320137 3.691318 3.585405 3.477585
 [825] 3.702859 3.496404 3.834725 3.182931 3.129443 3.340578 3.651763 3.846303
 [833] 3.172526 3.049635 4.116219 4.522650 3.778376 4.159857 4.000959 3.648635
 [841] 3.378219 3.274609 3.919474 4.096907 4.254369 4.409201 3.164627 3.048871
 [849] 3.640993 2.952619 3.269446 3.757164 3.165673 3.800969 3.501948 3.513101
 [857] 3.285009 3.289032 3.009537 3.135753 3.104035 3.692953 3.533382 3.873435
 [865] 3.371402 3.076619 3.553542 3.347792 3.524867 3.851137 3.573021 3.792690
 [873] 4.726681 3.419966 4.551700 3.718695 3.455996 2.997152 4.060747 3.516549
 [881] 3.057699 4.045652 3.697965 3.307657 3.250917 3.235020 3.255155 3.410850
 [889] 3.603788 3.265801 3.909863 3.305804 3.701584 3.421232 3.340366 4.251237
 [897] 3.932558 3.481889 3.686683 4.382681 3.140562 3.400008 3.077821 3.928243
 [905] 3.100623 3.264433 3.770700 3.308540 3.366591 3.472078 3.530759 3.602315
 [913] 4.105854 4.064646 3.099904 3.434358 3.410026 3.128126 3.779235 3.348105
 [921] 3.729641 3.451806 3.268224 3.540872 4.069521 3.843877 3.858831 3.852462
 [929] 3.876036 3.175229 3.486533 3.226961 3.795258 3.557319 3.874209 4.353848
 [937] 3.555665 3.513705 4.011576 3.842266 2.971988 3.349847 4.532810 3.801281
 [945] 2.914767 3.658050 3.709164 3.406191 3.623236 3.563127 3.581000 2.877455
 [953] 3.159940 4.567433 4.003815 3.424062 3.871608 3.234052 3.568383 3.048157
 [961] 4.235010 3.161186 3.623221 3.233762 4.169818 3.882942 2.771482 4.108877
 [969] 3.388578 3.456044 3.376549 4.903873 3.934038 3.453023 3.626691 3.214224
 [977] 3.423733 3.770653 3.255744 4.156287 3.162564 3.628929 4.409961 3.215500
 [985] 3.677095 4.195121 3.816188 3.143051 3.571218 3.506495 3.442149 3.371968
 [993] 3.099215 3.805297 3.285430 3.882673 3.638019 3.616644 3.582678 3.080668</code></pre>
</div>
</div>
</section>
<section id="inconsistency-i2" class="level3" data-number="6.9.4">
<h3 data-number="6.9.4" class="anchored" data-anchor-id="inconsistency-i2"><span class="header-section-number">6.9.4</span> Inconsistency I2</h3>
<p>The inconsistency <span class="math inline">\(I^2\)</span> index is the sum of the squared deviations from the overall effect and weighted by the study size. Value &lt;25% is classified as low and greater than 75% as high heterogeneity. This test can be performed using metafor package <span class="citation" data-cites="JSSv036i03">(<a href="references.html#ref-JSSv036i03" role="doc-biblioref">Viechtbauer 2010</a>)</span>. The presence of high <span class="math inline">\(I^2\)</span> suggests a need to proceed to meta-regression on the data to understand the source of heterogeneity. The fixed component were the covariates which were being tested for their effect on heterogeneity. The random effect components were the sensitivity and FPR. The <span class="math inline">\(I^2\)</span> value for the TIA clinic study is 34.41%. As such meta-regression is not needed for that study. By contrast, the <span class="math inline">\(I^2\)</span> is much higher for the spot sign study, necessitating metaregression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-193a5519d920a1d8ea99" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-193a5519d920a1d8ea99">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="metaanalysis-of-proportion" class="level3" data-number="6.9.5">
<h3 data-number="6.9.5" class="anchored" data-anchor-id="metaanalysis-of-proportion"><span class="header-section-number">6.9.5</span> Metaanalysis of proportion</h3>
<p>This is an example of metaanalysis of stroke recurrence following management in rapid TIA clinic. A variety of different methods for calculating the 95% confidence interval of the binomial distribution. The mean of the binomial distribution is given by p and the variance by <span class="math inline">\(\frac{p \times (1-p)}{n}\)</span>. The term <span class="math inline">\(z\)</span> is given by <span class="math inline">\(1-\frac{\alpha}{2}\)</span> quantile of normal distribution. A standard way of calculating the confidence interval is the Wald method <span class="math inline">\(p\pm z\times \sqrt{\frac{p \times(1-p)}{n}}\)</span>. The Freeman-Tukey double arcsine transformation tries to transform the data to a normal distribution. This approach is useful when occurence of event is rare. The exact or Clopper-Pearson method is suggested as the most conservative of the methods for calculating confidence interval for proportion. It is based on cumulative properties of the binomial distribution. The Wilson method has similarities to the Wald method. It has an extra term <span class="math inline">\(z^2/n\)</span>. There are many different methods for calculating the confidence interval for proportions. Investigators such as Agresti proposed that approximate methods are better than exact method <span class="citation" data-cites="doi:10.1080/00031305.1998.10480550">(<a href="references.html#ref-doi:10.1080/00031305.1998.10480550" role="doc-biblioref">Agresti and Coull 1998</a>)</span>. Brown and colleagues proposed the use of the Wilson method <span class="citation" data-cites="brown2001">(<a href="references.html#ref-brown2001" role="doc-biblioref">Brown, Cai, and DasGupta 2001</a>)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor) <span class="co">#open software metafor</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create data frame dat</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#xi is numerator</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ni is denominator</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model=</span><span class="fu">c</span>(<span class="st">"melbourne"</span>,<span class="st">"paris"</span>,<span class="st">"oxford"</span>,<span class="st">"stanford"</span>,<span class="st">"ottawa"</span>,<span class="st">"new zealand"</span>),</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="at">xi=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">2</span>), </span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="at">ni=</span><span class="fu">c</span>(<span class="dv">468</span>,<span class="dv">296</span>, <span class="dv">281</span>,<span class="dv">223</span>,<span class="dv">982</span>,<span class="dv">172</span>))</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate new variable pi base on ratio xi/ni</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>pi <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, xi<span class="sc">/</span>ni)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Freeman-Tukey double arcsine trasformation</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">"PFT"</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method=</span><span class="st">"REML"</span>, <span class="at">data=</span>dat, <span class="at">slab=</span><span class="fu">paste</span>(model))</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="co">#create forest plot with labels</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">transf=</span>transf.ipft.hm, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">ni=</span>dat<span class="sc">$</span>ni), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">1.4</span>),<span class="at">refline=</span>res<span class="sc">$</span>beta[<span class="dv">1</span>],</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>       <span class="co">#position of data on x-axis</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">4</span>),<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="co">#par function combine multiple plots into one</span></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.0</span>, <span class="fl">7.5</span>, <span class="st">"model "</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">"recurrence"</span>, <span class="st">" total subjects"</span>))</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.4</span>,<span class="fl">7.5</span>, <span class="st">"Proportion [95% CI]"</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Exact 95% confidence interval for proportion is provided below using the TIA data above. This solution was provided on <em>stack overflow</em>. This is performed using the <em>binomial.test</em> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exact confidence interval</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      melbourne new zealand     ottawa      oxford      paris    stanford
[1,] 0.00603419 0.001411309 0.02154780 0.007875285 0.00955965 0.001087992
[2,] 0.03057375 0.041370853 0.04451101 0.045893259 0.04811612 0.032020390</code></pre>
</div>
</div>
<p>The data needs to be transposed using <em>t</em> function. This generates one column for lower and another for upper CI. Note that sapply returns a matrix or array and the column names have to be assigned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the data</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]       [,2]
melbourne   0.006034190 0.03057375
new zealand 0.001411309 0.04137085
ottawa      0.021547797 0.04451101
oxford      0.007875285 0.04589326
paris       0.009559650 0.04811612
stanford    0.001087992 0.03202039</code></pre>
</div>
</div>
<p>The exact confidence is now put back into the dat data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>ci.lb <span class="ot">&lt;-</span> tmp[,<span class="dv">1</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>ci.ub <span class="ot">&lt;-</span> tmp[,<span class="dv">2</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">"PFT"</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.glmm</span>(<span class="at">measure=</span><span class="st">"PLO"</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co">#insert the exact confidence interval </span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dat, metafor<span class="sc">::</span><span class="fu">forest</span>(yi, <span class="at">ci.lb=</span>ci.lb, <span class="at">ci.ub=</span>ci.ub, </span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">8.5</span>), </span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="dv">1</span>), </span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refline=</span><span class="fu">predict</span>(res, <span class="at">transf=</span>transf.ilogit)<span class="sc">$</span>pred,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex=</span>.<span class="dv">8</span>, </span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">2</span>),<span class="at">digits=</span><span class="dv">3</span>))</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="fu">addpoly</span>(res, <span class="at">row=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">transf=</span>transf.ilogit)</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span>.<span class="dv">9</span>, <span class="fl">7.5</span>, <span class="st">"Model"</span>, <span class="at">pos=</span><span class="dv">2</span>)</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">"recurrence"</span>, <span class="st">" total subjects"</span>))</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>( <span class="dv">1</span>,   <span class="fl">7.5</span>, <span class="st">"Proportion [95% CI]"</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-16-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="metaanalysis-of-continuous-data" class="level3" data-number="6.9.6">
<h3 data-number="6.9.6" class="anchored" data-anchor-id="metaanalysis-of-continuous-data"><span class="header-section-number">6.9.6</span> Metaanalysis of continuous data</h3>
<p>Metanalysis of continuous outcome data can be performed using standardised mean difference or ratio of means. It is available in the <em>meta</em> library using <em>metacont</em> function <span class="citation" data-cites="doi10.1136/ebmental-2019-300117">(<a href="references.html#ref-doi10.1136/ebmental-2019-300117" role="doc-biblioref">Balduzzi, Rücker, and Schwarzer 2019</a>)</span>.</p>
</section>
<section id="bivariate-metaanalysis" class="level3" data-number="6.9.7">
<h3 data-number="6.9.7" class="anchored" data-anchor-id="bivariate-metaanalysis"><span class="header-section-number">6.9.7</span> Bivariate Metaanalysis</h3>
<p>The univariate method of Moses-Shapiro-Littenberg combines these measures (sensitivity and specificity) into a single measure of accuracy (diagnostic odds ratio)<span class="citation" data-cites="pmid8210827">(<a href="references.html#ref-pmid8210827" role="doc-biblioref">Moses, Shapiro, and Littenberg 1993</a>)</span> . This approach has been criticized for losing data on sensitivity and specificity of the test. Similar to the univariate method, the bivariate method employs a random effect to take into account the within study correlation <span class="citation" data-cites="pmid16168343">(<a href="references.html#ref-pmid16168343" role="doc-biblioref">Reitsma et al. 2005</a>)</span>. Additionally, the bivariate method also accounts for the between-study correlation in sensitivity and specificity. Bivariate analysis is performed using <em>mada</em> package. A [Bayesian library][Bayesian Metaanalysis] for bivariate analysis <em>meta4diag</em> is illustrated later.</p>
<p>The example below is taken from a metaanalysis of spot sign as predictor expansion of intracerebral hemorrhage <span class="citation" data-cites="pmid31272327">(<a href="references.html#ref-pmid31272327" role="doc-biblioref">Phan et al. 2019</a>)</span>. The data for this analysis is available in the Data-Use sub-folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mada)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ellipse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ellipse'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    pairs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvmeta</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is mvmeta 1.0.3. For an overview type: help('mvmeta-package').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mvmeta'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:metafor':

    blup</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:meta':

    blup</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:checkmate':

    qtest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mada'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:metafor':

    forest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:meta':

    forest</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#spot sign data</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>Data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"./Data-Use/ss150718.csv"</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co">#remove duplicates using subset</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co">#another way is to use filter from dplyr</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>Dat<span class="ot">&lt;-</span><span class="fu">subset</span>(Data, Data<span class="sc">$</span>retain<span class="sc">==</span><span class="st">"yes"</span>) </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>(ss<span class="ot">&lt;-</span><span class="fu">reitsma</span>(Dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:  reitsma.default(data = Dat)

Fixed-effects coefficients:
              tsens     tfpr
(Intercept)  0.2548  -1.9989

27 studies, 2 fixed and 3 random-effects parameters
  logLik       AIC       BIC  
 52.0325  -94.0650  -84.1201  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:  reitsma.default(data = Dat)

Bivariate diagnostic random-effects meta-analysis
Estimation method: REML

Fixed-effects coefficients
                  Estimate Std. Error       z Pr(&gt;|z|) 95%ci.lb 95%ci.ub    
tsens.(Intercept)    0.255      0.152   1.676    0.094   -0.043    0.553   .
tfpr.(Intercept)    -1.999      0.097 -20.664    0.000   -2.189   -1.809 ***
sensitivity          0.563          -       -        -    0.489    0.635    
false pos. rate      0.119          -       -        -    0.101    0.141    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Variance components: between-studies Std. Dev and correlation matrix
      Std. Dev  tsens  tfpr
tsens    0.692  1.000     .
tfpr     0.400 -0.003 1.000

 logLik     AIC     BIC 
 52.033 -94.065 -84.120 

AUC:  0.858
Partial AUC (restricted to observed FPRs and normalized):  0.547

I2 estimates 
Zhou and Dendukuri approach:  10.2 % 
Holling sample size unadjusted approaches:  64.2 - 79.9 % 
Holling sample size adjusted approaches:  4.7 - 5 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AUC</span>(<span class="fu">reitsma</span>(<span class="at">data =</span> Dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$AUC
[1] 0.8576619

$pAUC
[1] 0.5474316

attr(,"sroc.type")
[1] "ruttergatsonis"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>sumss<span class="ot">&lt;-</span><span class="fu">SummaryPts</span>(ss,<span class="at">n.iter =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>) <span class="co">#bivariate pooled LR</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sumss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Mean Median  2.5%  97.5%
posLR    4.740  4.720 3.780  5.760
negLR    0.496  0.496 0.413  0.582
invnegLR 2.030  2.020 1.720  2.420
DOR      9.700  9.530 6.790 13.500</code></pre>
</div>
</div>
</section>
<section id="metaanalysis-of-clinical-trial." class="level3" data-number="6.9.8">
<h3 data-number="6.9.8" class="anchored" data-anchor-id="metaanalysis-of-clinical-trial."><span class="header-section-number">6.9.8</span> Metaanalysis of clinical trial.</h3>
<p>Fixed effect (Peto or Mantel-Haenszel) approaches assume that the population is the same for all studies and thus each study is the source of error. Random effect (DerSimonian Laird) assumes an additional source of error between studies.The random effect approach results in more conservate estimate of effect size confidence interval. A criticism of DerSimnonian and Laird approach is that it is prone to type I error especially when the number of number of studies is small (n&lt;20) or moderate heterogeneity. It’s estimated that 25% of the significant findings with DerSimonian Laird method may be non-significant with Hartung-Knapp method (BMC Medical Research Methodology 2014, 14:25). The Hartung-Knapp method (Stat Med 2001;20:3875-89) estimate the between studies variance and treat it as fixed. It employs quantile of t-distribution rather than normal distribution. The Hartung-Knapp method is available in meta and metafor package.</p>
<p>The data is from Jama Cardiology on Associations of Omega-3 Fatty Acid Supplement Use With Cardiovascular Disease Risks Meta-analysis of 10 Trials Involving 77917 Individuals <span class="citation" data-cites="pmid29387889">(<a href="references.html#ref-pmid29387889" role="doc-biblioref">Aung T 2018</a>)</span>. Subsequently a meta-analysis <span class="citation" data-cites="pmid31567003">(<a href="references.html#ref-pmid31567003" role="doc-biblioref">Hu 2019</a>)</span> reported that contrary to the earlier meta-analysis, Omega-3 lowers the risk of cardiovascular diseases with effect related to dose. The analysis using DerSimonian Laird and Hartung Knapp method is illustrated below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.4
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::%@%()           masks rlang::%@%()
✖ rlang:::=()            masks data.table:::=()
✖ dplyr::between()       masks data.table::between()
✖ readr::col_factor()    masks scales::col_factor()
✖ dplyr::collapse()      masks nlme::collapse()
✖ gridExtra::combine()   masks dplyr::combine()
✖ matrixStats::count()   masks dplyr::count()
✖ dplyr::data_frame()    masks tibble::data_frame(), vctrs::data_frame()
✖ dplyr::dim_desc()      masks pillar::dim_desc()
✖ purrr::discard()       masks scales::discard()
✖ tidyr::expand()        masks Matrix::expand()
✖ tidyr::extract()       masks magrittr::extract()
✖ dplyr::filter()        masks stats::filter()
✖ dplyr::first()         masks data.table::first()
✖ purrr::flatten()       masks jsonlite::flatten(), rlang::flatten()
✖ purrr::flatten_chr()   masks rlang::flatten_chr()
✖ purrr::flatten_dbl()   masks rlang::flatten_dbl()
✖ purrr::flatten_int()   masks rlang::flatten_int()
✖ purrr::flatten_lgl()   masks rlang::flatten_lgl()
✖ purrr::flatten_raw()   masks rlang::flatten_raw()
✖ lubridate::hour()      masks data.table::hour()
✖ purrr::invoke()        masks rlang::invoke()
✖ lubridate::isoweek()   masks data.table::isoweek()
✖ dplyr::lag()           masks stats::lag()
✖ dplyr::last()          masks data.table::last()
✖ rlang::ll()            masks Metrics::ll()
✖ rlang::local_options() masks withr::local_options()
✖ purrr::map()           masks listenv::map()
✖ lubridate::mday()      masks data.table::mday()
✖ lubridate::minute()    masks data.table::minute()
✖ lubridate::month()     masks data.table::month()
✖ tidyr::pack()          masks Matrix::pack()
✖ lubridate::quarter()   masks data.table::quarter()
✖ lubridate::second()    masks data.table::second()
✖ dplyr::select()        masks MASS::select()
✖ purrr::set_names()     masks rlang::set_names(), magrittr::set_names()
✖ readr::spec()          masks mada::spec()
✖ purrr::splice()        masks rlang::splice()
✖ dplyr::src()           masks Hmisc::src()
✖ cli::style_bold()      masks pillar::style_bold()
✖ dplyr::summarize()     masks Hmisc::summarize()
✖ purrr::transpose()     masks data.table::transpose()
✖ cli::tree()            masks xfun::tree()
✖ jsonlite::unbox()      masks rlang::unbox()
✖ tidyr::unpack()        masks Matrix::unpack()
✖ jsonlite::validate()   masks rms::validate()
✖ lubridate::wday()      masks data.table::wday()
✖ lubridate::week()      masks data.table::week()
✖ rlang::with_options()  masks withr::with_options()
✖ lubridate::yday()      masks data.table::yday()
✖ lubridate::year()      masks data.table::year()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Omega 3 data</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>Year<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">2014</span>,<span class="dv">2010</span>,<span class="dv">2007</span>,<span class="dv">2010</span>,<span class="dv">2010</span>,<span class="dv">2013</span>,<span class="dv">2008</span>,<span class="dv">2012</span>,<span class="dv">1999</span>)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>Trials<span class="ot">=</span><span class="fu">c</span>(<span class="st">"DOIT"</span>,<span class="st">"AREDS-2"</span>,<span class="st">"SU.FOL.OM3"</span>,<span class="st">"JELIS"</span>,<span class="st">"Alpha Omega"</span>,<span class="st">"OMEGA"</span>,<span class="st">"R&amp;P"</span>,<span class="st">"GISSI-HF"</span>,<span class="st">"ORIGIN"</span>,<span class="st">"GISSI-P"</span>)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>Treatment<span class="ot">=</span><span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">213</span>,<span class="dv">216</span>,<span class="dv">262</span>,<span class="dv">332</span>,<span class="dv">534</span>,<span class="dv">733</span>,<span class="dv">783</span>,<span class="dv">1276</span>,<span class="dv">1552</span>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>Treatment.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">10.3</span>,<span class="fl">9.9</span>,<span class="fl">17.2</span>,<span class="fl">2.8</span>,<span class="fl">13.8</span>,<span class="fl">27.7</span>,<span class="fl">11.7</span>,<span class="fl">22.4</span>,<span class="fl">20.3</span>,<span class="fl">27.4</span>)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>Control<span class="ot">=</span><span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">208</span>,<span class="dv">211</span>,<span class="dv">324</span>,<span class="dv">331</span>,<span class="dv">541</span>,<span class="dv">745</span>,<span class="dv">831</span>,<span class="dv">1295</span>,<span class="dv">1550</span>)</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>Control.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">12.5</span>,<span class="fl">10.1</span>,<span class="fl">16.9</span>,<span class="fl">3.5</span>,<span class="fl">13.6</span>,<span class="fl">28.6</span>, <span class="fl">11.9</span>,<span class="fl">23.9</span>,<span class="fl">20.7</span>,<span class="fl">27.3</span>)</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="co">#combine into data frame</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>rct<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Year,Trials,Treatment,Treatment.per,Control,Control.per) <span class="sc">%&gt;%</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment.number=</span><span class="fu">round</span>(Treatment<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Treatment.per,<span class="dv">0</span>),</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Control.number=</span><span class="fu">round</span>(Control<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Control.per,<span class="dv">0</span>), <span class="at">group=</span><span class="fu">ifelse</span>(Year<span class="sc">&gt;</span><span class="dv">2010</span>,<span class="st">"wide"</span>,<span class="st">"narrow"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ai=</span>Treatment,<span class="at">n1i=</span>Treatment.number,<span class="at">ci=</span>Control,</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">n2i=</span>Control.number,<span class="at">study=</span>Trials) </span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="co">#peto's fixed effect method</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.peto</span>(<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i, <span class="at">data=</span>rct)</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Equal-Effects Model (k = 10)

I^2 (total heterogeneity / total variability):  0.00%
H^2 (total variability / sampling variability): 0.93

Test for Heterogeneity: 
Q(df = 9) = 8.36, p-val = 0.50

Model Results (log scale):

estimate    se   zval  pval  ci.lb  ci.ub 
   -0.04  0.02  -1.72  0.08  -0.08   0.00 

Model Results (OR scale):

estimate  ci.lb  ci.ub 
    0.97   0.93   1.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">predict</span>(res, <span class="at">transf=</span>exp, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co">#forest plot</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">study=</span>rct<span class="sc">$</span>study), </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">"RCT of Omega3 fatty acid for cardiovascular disease-Peto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The funnel plot is used here to illustrate presence or absence publication bias. In this case the funnel plot reflects the same findings as the low <span class="math inline">\(I^2\)</span> value. There is one outlier. We will explore this further with the <em>GOSH</em> plot below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># funnel plot </span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel</span>(res, <span class="at">refline=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">99</span>), </span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">shade=</span><span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"gray"</span>, <span class="st">"darkgray"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Random effect (DerSimonian Laird) assumes an additional source of error between studies when calculating odds ratio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DL</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>datO3 <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure =</span> <span class="st">"OR"</span>,<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i,<span class="at">data=</span>rct)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>res.DL<span class="ot">&lt;-</span><span class="fu">rma</span>(yi,vi, <span class="at">method =</span> <span class="st">"DL"</span>,<span class="at">data=</span>datO3)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.DL,<span class="at">main=</span><span class="st">"RCT of Omega3 fatty acid for cardiovascular disease-DL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>DerSimonian Laird method may not be appropriate for metaanalysis with small number of studies . The recommendation is to use the Hartung Knapp random effect method. This analysis show that inspite of the small sample size the significant findings remain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hartung-ignore error message</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>res.HK<span class="ot">&lt;-</span><span class="fu">rma.uni</span>(yi,<span class="at">vi=</span><span class="dv">1</span><span class="sc">/</span>vi,<span class="at">method=</span><span class="st">"FE"</span>,<span class="at">knha=</span><span class="cn">TRUE</span>,<span class="at">data=</span>datO3)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.HK,<span class="at">main=</span><span class="st">"RCT of Omega3 fatty acid for cardiovascular disease-HK"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Subgroup analysis is one way of exploring the data for group effect. Metaregression is illustrated later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#datO3$group&lt;-rct3$group</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot subgroups</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>res.group <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">mods =</span> <span class="sc">~</span> group, <span class="at">data=</span>datO3)</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>res.wide<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">"wide"</span>), <span class="at">data=</span>datO3)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>res.wide</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>res.narrow<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">"narrow"</span>), <span class="at">data=</span>datO3)</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>res.narrow</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/39392706/using-the-r-forestplot-package-</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="co">#is-there-a-way-to-assign-variable-colors-to-boxe</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co">#confidence interval</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>rmeta_conf <span class="ot">&lt;-</span> </span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(<span class="fu">list</span>(</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean  =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0676</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0266</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0352</span>)), </span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.1873</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0715</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0753</span>)),</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0520</span>), <span class="fu">exp</span>(<span class="fl">0.0183</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0049</span>))),</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.Names =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>), </span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="sc">-</span><span class="dv">6</span>L), </span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a><span class="co">#table data</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>tabletext<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"Trials"</span>,<span class="st">"wide"</span>,<span class="st">"narrow"</span>,<span class="cn">NA</span>,<span class="st">"Summary"</span>),</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Events"</span>,<span class="st">"(Drugs)"</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">"wide"</span>)<span class="sc">$</span>ai),</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">"narrow"</span>)<span class="sc">$</span>ai),<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Events"</span>,<span class="st">"(Control)"</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">"wide"</span>)<span class="sc">$</span>ci),</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">"narrow"</span>)<span class="sc">$</span>ci),<span class="cn">NA</span>,<span class="cn">NA</span>),     </span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">""</span>,<span class="st">"OR"</span>,<span class="st">"0.934"</span>,<span class="st">"0.974"</span>,<span class="cn">NA</span>,<span class="st">"0.965"</span>)</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a><span class="co">#use forestplot as another library to perform forest plot</span></span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forestplot)</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a> <span class="fu">forestplot</span>(tabletext, </span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>       rmeta_conf,<span class="at">new_page =</span> <span class="cn">TRUE</span>,</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">is.summary=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="fu">rep</span>(<span class="cn">FALSE</span>,<span class="dv">8</span>),<span class="cn">TRUE</span>),</span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">clip=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">2.5</span>), </span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlog=</span><span class="cn">TRUE</span>, </span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">fpColors</span>(<span class="at">box=</span><span class="st">"royalblue"</span>,<span class="at">line=</span><span class="st">"darkblue"</span>, <span class="at">summary=</span><span class="st">"royalblue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Baujat plot is another method in addition to funnel plot explore heterogeneity</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust margins so the space is better used</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create Baujat plot to explore source of heterogeneity</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">baujat</span>(res.DL, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>GOSH plot explores study heterogeneity using output of fixed effect model for all possible subsets</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">## fit FE model to all possible subsets</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co"># uses output from DL analysis</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>sav <span class="ot">&lt;-</span> <span class="fu">gosh</span>(res.DL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting 1023 models (based on all possible subsets).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">### create GOSH plot</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="do">### red points for subsets that include and blue points</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="do">### for subsets that exclude study 16 (the ISIS-4 trial)</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sav, <span class="at">out=</span><span class="fu">dim</span>(rct)[<span class="dv">1</span>], <span class="at">breaks=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="metaregression" class="level3" data-number="6.9.9">
<h3 data-number="6.9.9" class="anchored" data-anchor-id="metaregression"><span class="header-section-number">6.9.9</span> Metaregression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#separate metaregression for tsens and tfpr</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#tsens - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>(metass<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span>PubYear<span class="sc">+</span>Study.type<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
    Study.type + Setting + Quality.assessment)

Fixed-effects coefficients:
                       tsens       tfpr
(Intercept)         298.7348  -164.8603
PubYear              -0.1484     0.0828
Study.typeRetro       0.3554    -0.1489
SettingSingle         0.2283    -0.1301
Quality.assessment   -0.0040    -0.0834

26 studies, 10 fixed and 3 random-effects parameters
  logLik       AIC       BIC  
 48.5386  -71.0771  -45.7109  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(metass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
    Study.type + Setting + Quality.assessment)

Bivariate diagnostic random-effects meta-regression
Estimation method: REML

Fixed-effects coefficients
                         Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
tsens.(Intercept)         298.735    143.547  2.081    0.037   17.387  580.083
tsens.PubYear              -0.148      0.071 -2.078    0.038   -0.288   -0.008
tsens.Study.typeRetro       0.355      0.310  1.146    0.252   -0.253    0.963
tsens.SettingSingle         0.228      0.495  0.462    0.644   -0.741    1.198
tsens.Quality.assessment   -0.004      0.050 -0.081    0.936   -0.102    0.094
tfpr.(Intercept)         -164.860     80.574 -2.046    0.041 -322.783   -6.938
tfpr.PubYear                0.083      0.040  2.066    0.039    0.004    0.161
tfpr.Study.typeRetro       -0.149      0.172 -0.865    0.387   -0.486    0.188
tfpr.SettingSingle         -0.130      0.276 -0.471    0.638   -0.672    0.412
tfpr.Quality.assessment    -0.083      0.026 -3.190    0.001   -0.135   -0.032
                           
tsens.(Intercept)         *
tsens.PubYear             *
tsens.Study.typeRetro      
tsens.SettingSingle        
tsens.Quality.assessment   
tfpr.(Intercept)          *
tfpr.PubYear              *
tfpr.Study.typeRetro       
tfpr.SettingSingle         
tfpr.Quality.assessment  **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Variance components: between-studies Std. Dev and correlation matrix
      Std. Dev tsens  tfpr
tsens    0.657 1.000     .
tfpr     0.297 0.312 1.000

 logLik     AIC     BIC 
 48.539 -71.077 -45.711 


I2 estimates 
Zhou and Dendukuri approach:  0 % 
Holling sample size unadjusted approaches:  66.8 - 80.5 % 
Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tfpr - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>(metassfull<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>        PubYear<span class="sc">+</span>clinical<span class="sc">+</span>Study.type<span class="sc">+</span>CTA6hrs<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
    clinical + Study.type + CTA6hrs + Setting + Quality.assessment)

Fixed-effects coefficients:
                       tsens       tfpr
(Intercept)         297.5416  -144.2754
PubYear              -0.1480     0.0724
clinical             -0.4703    -0.1810
Study.typeRetro       0.4884    -0.0989
CTA6hrsyes           -0.2141    -0.2342
SettingSingle         0.2568    -0.1435
Quality.assessment    0.0130    -0.0738

26 studies, 14 fixed and 3 random-effects parameters
  logLik       AIC       BIC  
 48.4477  -62.8955  -29.7243  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(metassfull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
    clinical + Study.type + CTA6hrs + Setting + Quality.assessment)

Bivariate diagnostic random-effects meta-regression
Estimation method: REML

Fixed-effects coefficients
                         Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
tsens.(Intercept)         297.542    150.543  1.976    0.048    2.482  592.601
tsens.PubYear              -0.148      0.075 -1.977    0.048   -0.295   -0.001
tsens.clinical             -0.470      0.333 -1.411    0.158   -1.124    0.183
tsens.Study.typeRetro       0.488      0.321  1.523    0.128   -0.140    1.117
tsens.CTA6hrsyes           -0.214      0.322 -0.665    0.506   -0.845    0.417
tsens.SettingSingle         0.257      0.495  0.519    0.604   -0.714    1.228
tsens.Quality.assessment    0.013      0.051  0.255    0.799   -0.087    0.113
tfpr.(Intercept)         -144.275     82.720 -1.744    0.081 -306.403   17.852
tfpr.PubYear                0.072      0.041  1.761    0.078   -0.008    0.153
tfpr.clinical              -0.181      0.187 -0.969    0.333   -0.547    0.185
tfpr.Study.typeRetro       -0.099      0.177 -0.558    0.577   -0.446    0.249
tfpr.CTA6hrsyes            -0.234      0.177 -1.322    0.186   -0.581    0.113
tfpr.SettingSingle         -0.144      0.274 -0.524    0.600   -0.680    0.393
tfpr.Quality.assessment    -0.074      0.027 -2.774    0.006   -0.126   -0.022
                           
tsens.(Intercept)         *
tsens.PubYear             *
tsens.clinical             
tsens.Study.typeRetro      
tsens.CTA6hrsyes           
tsens.SettingSingle        
tsens.Quality.assessment   
tfpr.(Intercept)          .
tfpr.PubYear              .
tfpr.clinical              
tfpr.Study.typeRetro       
tfpr.CTA6hrsyes            
tfpr.SettingSingle         
tfpr.Quality.assessment  **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Variance components: between-studies Std. Dev and correlation matrix
      Std. Dev tsens  tfpr
tsens    0.650 1.000     .
tfpr     0.285 0.188 1.000

 logLik     AIC     BIC 
 48.448 -62.895 -29.724 


I2 estimates 
Zhou and Dendukuri approach:  0 % 
Holling sample size unadjusted approaches:  66.8 - 80.5 % 
Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
</div>
</div>
<p>Plot year against tsens from metaregression</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using output from spot sign</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>ssr<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(ss<span class="sc">$</span>residuals)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="co">#convert character to year</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>ssr<span class="sc">$</span>Year<span class="ot">&lt;-</span><span class="fu">as.Date</span>(<span class="fu">as.character</span>(Dat<span class="sc">$</span>PubYear),<span class="st">"%Y"</span>)</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>ssr<span class="sc">$</span>Quality<span class="ot">&lt;-</span>Dat<span class="sc">$</span>Quality.assessment</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ssr, <span class="fu">aes</span>(<span class="at">x=</span>ssr<span class="sc">$</span>Year,<span class="at">y=</span>ssr<span class="sc">$</span>tsens))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Relationship between transformed sensitivity and Publication Year"</span>)<span class="sc">+</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Year"</span>,<span class="at">y=</span><span class="st">"transformed sensitivity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistics_files/figure-html/Statistics-17-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="summary-positive-and-negative-likelihood-ratio" class="level4" data-number="6.9.9.1">
<h4 data-number="6.9.9.1" class="anchored" data-anchor-id="summary-positive-and-negative-likelihood-ratio"><span class="header-section-number">6.9.9.1</span> summary Positive and Negative Likelihood Ratio</h4>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with target disorder compared with the likelihood that the same result would be expected in a patient without target disorder. Using the recommendation by Jaeschke et al<span class="citation" data-cites="pmid8309035">(<a href="references.html#ref-pmid8309035" role="doc-biblioref">Jaeschke, Guyatt, and Sackett 1994</a>)</span> a high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk. PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk. The pooled likelihood ratios were used to calculate post-test odds according to Bayes’ Theorem and post-test probabilities of outcome after a positive test result for a range of possible values of baseline risk.</p>
<p>Data from likelihood ratio can be used to create Fagan’s normogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The code for this is available at</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="co">#"https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r"</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nomogrammer)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Fagan's normogram for Spot Sign and ICH growth"</span>)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(p,file="Fagan_SpotSign.png",width=5.99,height=3.99,units="in")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="data-simulation" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="data-simulation"><span class="header-section-number">6.10</span> Data simulation</h2>
<p>Data simulation is an important aspects of data science. The example below is taken from our experience trying to simulate data from recent clot retrieval trials in stroke <span class="citation" data-cites="pmid25517348">(<a href="references.html#ref-pmid25517348" role="doc-biblioref">Berkhemer et al. 2015</a>)</span> <span class="citation" data-cites="pmid25671797">(<a href="references.html#ref-pmid25671797" role="doc-biblioref">Campbell et al. 2015</a>)</span>. Simulation is performed using <em>simstudy</em> library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (simstudy)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co">#T is Trial</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"T"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">formula =</span> <span class="fl">0.5</span>)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co">#early neurological improvement (ENI) .37 in TPA and .8 in ECR</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"ENI"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> .<span class="dv">8</span><span class="fl">-.53</span><span class="sc">*</span>T, <span class="at">variance =</span> .<span class="dv">1</span>)</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"Y1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula=</span><span class="dv">13</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"Y2"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"Y1*ENI - 5 * T &gt;5"</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"Y3"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"Y2- 4*T&gt;2"</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">"Y4"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"Y3- 2*T&gt;0"</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a><span class="co">#male</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">"Male"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">formula =</span> <span class="fl">0.49</span><span class="sc">*</span>T)</span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a><span class="co">#diabetes .23 in TPA and .06 in ECR</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">"Diabetes"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">formula =</span> .<span class="dv">23</span><span class="fl">-.17</span><span class="sc">*</span>T)</span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a><span class="co">#HT .66 TPA vs .6 ECR</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">"HT"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">formula =</span> .<span class="dv">66</span><span class="fl">-.06</span><span class="sc">*</span>T)</span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a><span class="co">#generate data frame</span></span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a>dtTrial <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a><span class="co">#define parameter for mRS</span></span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-36"><a href="#cb177-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Add conditional column with field name "mRS"</span></span>
<span id="cb177-37"><a href="#cb177-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-38"><a href="#cb177-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-39"><a href="#cb177-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-40"><a href="#cb177-40" aria-hidden="true" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">4</span>, <span class="at">idvars =</span> <span class="st">"id"</span>, </span>
<span id="cb177-41"><a href="#cb177-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span>,<span class="st">"Y4"</span>), <span class="at">timevarName =</span> <span class="st">"Y"</span>)</span>
<span id="cb177-42"><a href="#cb177-42" aria-hidden="true" tabindex="-1"></a>dtTime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id period T       ENI Male Diabetes HT          Y timeID
   1:   1      0 1 0.2888235    0        0  0 13.7430043      1
   2:   1      1 1 0.2888235    0        0  0  1.4892292      2
   3:   1      2 1 0.2888235    0        0  0 -0.3249935      3
   4:   1      3 1 0.2888235    0        0  0 -1.0565860      4
   5:   2      0 1 0.1940514    0        0  0 12.5764834      5
  ---                                                          
1996: 499      3 1 0.2227292    0        0  1 -1.4363097   1996
1997: 500      0 0 0.5754765    1        0  1 14.1556444   1997
1998: 500      1 0 0.5754765    1        0  1  2.1193367   1998
1999: 500      2 0 0.5754765    1        0  1  2.7750694   1999
2000: 500      3 0 0.5754765    1        0  1  1.4107691   2000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check  that 2 groups are similar at start but not at finish</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Y1<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Y1 by T
t = 0.01362, df = 461.78, p-value = 0.9891
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.176228  0.178688
sample estimates:
mean in group 0 mean in group 1 
       13.06803        13.06680 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Y4<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Y4 by T
t = 4.8311, df = 442.66, p-value = 1.875e-06
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 0.2792413 0.6622504
sample estimates:
mean in group 0 mean in group 1 
     0.45056170     -0.02018415 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Male<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Male by T
t = -0.43618, df = 484.68, p-value = 0.6629
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.10750681  0.06844721
sample estimates:
mean in group 0 mean in group 1 
      0.4454148       0.4649446 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#putting the 4 time periods together - long format</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">3</span>, <span class="at">idvars =</span> <span class="st">"id"</span>, <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span>,<span class="st">"Y4"</span>), <span class="at">timevarName =</span> <span class="st">"Y"</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co">#summarise data using group_by</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>dtTime2<span class="ot">&lt;-</span>dtTime <span class="sc">%&gt;%</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period, T) <span class="sc">%&gt;%</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanY=</span><span class="fu">mean</span>(Y),</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sdY=</span><span class="fu">sd</span>(Y),</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">upperY=</span>meanY<span class="sc">+</span>sdY,</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerY=</span>meanY<span class="sc">-</span>sdY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'period'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(dtTime, file="./Data-Use/dtTime_simulated.csv")</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(dtTrial,          file="./Data-Use/dtTrial_simulated.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-doi:10.1080/00031305.1998.10480550" class="csl-entry" role="listitem">
Agresti, Alan, and Brent A. Coull. 1998. <span>“Approximate Is Better Than <span>‘Exact’</span> for Interval Estimation of Binomial Proportions.”</span> <em>The American Statistician</em> 52 (2): 119–26. <a href="https://doi.org/10.1080/00031305.1998.10480550">https://doi.org/10.1080/00031305.1998.10480550</a>.
</div>
<div id="ref-pmid29387889" class="csl-entry" role="listitem">
Aung T, Kromhout D, Halsey J. 2018. <span>“Associations of Omega-3 Fatty Acid Supplement Use with Cardiovascular Disease Risks: Meta-Analysis of 10 Trials Involving 77 917 Individuals.”</span> <em>Jama Cardiol</em>, March. <a href="https://doi.org/doi: 10.1001/jamacardio.2017.5205">https://doi.org/doi: 10.1001/jamacardio.2017.5205</a>.
</div>
<div id="ref-doi10.1136/ebmental-2019-300117" class="csl-entry" role="listitem">
Balduzzi, Sara, Gerta Rücker, and Guido Schwarzer. 2019. <span>“How to Perform a Meta-Analysis with <span>R</span>: A Practical Tutorial.”</span> <em>Evidence-Based Mental Health</em>, no. 22: 153–60.
</div>
<div id="ref-pmid25517348" class="csl-entry" role="listitem">
Berkhemer, O. A., P. S. Fransen, D. Beumer, L. A. van den Berg, H. F. Lingsma, A. J. Yoo, W. J. Schonewille, et al. 2015. <span>“<span class="nocase"><span>A</span> randomized trial of intraarterial treatment for acute ischemic stroke</span>.”</span> <em>N. Engl. J. Med.</em> 372 (1): 11–20.
</div>
<div id="ref-pmid10700737" class="csl-entry" role="listitem">
BJ, Biggerstaff. 2000. <span>“Comparing Diagnostic Tests: A Simple Graphic Using Likelihood Ratios.”</span> <em>Stat Med</em> 19 (March): 649–63. <a href="https://doi.org/10.1002/(sici)1097-0258(20000315)19:5<649::aid-sim371>3.0.co;2-h">https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h</a>.
</div>
<div id="ref-brown2001" class="csl-entry" role="listitem">
Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. <span>“Interval Estimation for a Binomial Proportion.”</span> <em>Statist. Sci.</em> 16 (2): 101–33. <a href="https://doi.org/10.1214/ss/1009213286">https://doi.org/10.1214/ss/1009213286</a>.
</div>
<div id="ref-pmid25671797" class="csl-entry" role="listitem">
Campbell, B. C., P. J. Mitchell, T. J. Kleinig, H. M. Dewey, L. Churilov, N. Yassi, B. Yan, et al. 2015. <span>“<span class="nocase"><span>E</span>ndovascular therapy for ischemic stroke with perfusion-imaging selection</span>.”</span> <em>N. Engl. J. Med.</em> 372 (11): 1009–18.
</div>
<div id="ref-COHEN1977179" class="csl-entry" role="listitem">
Cohen, Jacob. 1977. <span>“CHAPTER 6 - Differences Between Proportions.”</span> In <em>Statistical Power Analysis for the Behavioral Sciences</em>, edited by Jacob Cohen, 179–213. Academic Press. https://doi.org/<a href="https://doi.org/10.1016/B978-0-12-179060-8.50011-6">https://doi.org/10.1016/B978-0-12-179060-8.50011-6</a>.
</div>
<div id="ref-pmid1738016" class="csl-entry" role="listitem">
Diamond, G. A. 1992. <span>“<span class="nocase"><span>W</span>hat price perfection? <span>C</span>alibration and discrimination of clinical prediction models</span>.”</span> <em>J Clin Epidemiol</em> 45 (1): 85–89.
</div>
<div id="ref-pmid25781447" class="csl-entry" role="listitem">
Gopal, A. D., N. R. Desai, T. Tse, and J. S. Ross. 2015. <span>“<span class="nocase"><span>R</span>eporting of noninferiority trials in <span>C</span>linical<span>T</span>rials.gov and corresponding publications</span>.”</span> <em>JAMA</em> 313 (11): 1163–65.
</div>
<div id="ref-pmid10474158" class="csl-entry" role="listitem">
Graf E, Sauerbrei W, Schmoor C. 1999. <span>“Assessment and Comparison of Prognostic Classification Schemes for Survival Data.”</span> <em>Stat Med</em> 18 (September): 2529–45. <a href="https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18<2529::aid-sim274>3.0.co;2-5">https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5</a>.
</div>
<div id="ref-10.1093/biomet/81.3.515" class="csl-entry" role="listitem">
Grambsch, P. M., and T. M. Therneau. 1994. <span>“<span class="nocase">Proportional hazards tests and diagnostics based on weighted residuals</span>.”</span> <em>Biometrika</em> 81 (3): 515–26. <a href="https://doi.org/10.1093/biomet/81.3.515">https://doi.org/10.1093/biomet/81.3.515</a>.
</div>
<div id="ref-pmid7069920" class="csl-entry" role="listitem">
Harrell FE Jr, Pryor DB, Califf RM. 1982. <span>“Evaluating the Yield of Medical Tests.”</span> <em>JAMA</em> 247 (May): 2543–46.
</div>
<div id="ref-pmid31567003" class="csl-entry" role="listitem">
Hu, Hu, Y. 2019. <span>“Marine Omega‐3 Supplementation and Cardiovascular Disease: An Updated Meta‐analysis of 13 Randomized Controlled Trials Involving 127 477 Participants.”</span> <em>JAHA</em>, September. https://doi.org/<a href="https://doi.org/10.1161/JAHA.119.013543">https://doi.org/10.1161/JAHA.119.013543</a>.
</div>
<div id="ref-pmid15345796" class="csl-entry" role="listitem">
Ingall, Timothy John, William Michael O’Fallon, Kjell Asplund, Lewis Robert Goldfrank, Vicki S. Hertzberg, Thomas Arthur Louis, and Teresa J. Hengy Christianson. 2004. <span>“Findings from the Reanalysis of the NINDS Tissue Plasminogen Activator for Acute Ischemic Stroke Treatment Trial.”</span> <em>Stroke</em> 35 (10): 2418–24. <a href="https://doi.org/10.1161/01.STR.0000140891.70547.56">https://doi.org/10.1161/01.STR.0000140891.70547.56</a>.
</div>
<div id="ref-pmid33250548" class="csl-entry" role="listitem">
J, Muschelli. 2020. <span>“ROC and AUC with a Binary Predictor: A Potentially Misleading Metric.”</span> <em>J Classif</em> 37 (October): 696–708. <a href="https://doi.org/10.1007/s00357-019-09345-1">https://doi.org/10.1007/s00357-019-09345-1</a>.
</div>
<div id="ref-pmid8309035" class="csl-entry" role="listitem">
Jaeschke, R., G. H. Guyatt, and D. L. Sackett. 1994. <span>“<span class="nocase"><span>U</span>sers’ guides to the medical literature. <span>I</span><span>I</span><span>I</span>. <span>H</span>ow to use an article about a diagnostic test. <span>B</span>. <span>W</span>hat are the results and will they help me in caring for my patients? <span>T</span>he <span>E</span>vidence-<span>B</span>ased <span>M</span>edicine <span>W</span>orking <span>G</span>roup</span>.”</span> <em>JAMA</em> 271 (9): 703–7.
</div>
<div id="ref-10.1186/1745-6215-15-139" class="csl-entry" role="listitem">
Kahan, Jairath, B. C. 2014. <span>“The Risks and Rewards of Covariate Adjustment in Randomized Trials: An Assessment of 12 Outcomes from 8 Studies.”</span> <em>Trials</em> 15: 139. <a href="https://doi.org/10.1186/1745-6215-15-139">https://doi.org/10.1186/1745-6215-15-139</a>.
</div>
<div id="ref-pmid26080342" class="csl-entry" role="listitem">
Kaji, A. H., and R. J. Lewis. 2015. <span>“<span class="nocase"><span>N</span>oninferiority <span>T</span>rials: <span>I</span>s a <span>N</span>ew <span>T</span>reatment <span>A</span>lmost as <span>E</span>ffective as <span>A</span>nother?</span>”</span> <em>JAMA</em> 313 (23): 2371–72.
</div>
<div id="ref-LONGATO2020103496" class="csl-entry" role="listitem">
Longato, Enrico, Martina Vettoretti, and Barbara Di Camillo. 2020. <span>“A Practical Perspective on the Concordance Index for the Evaluation and Selection of Prognostic Time-to-Event Models.”</span> <em>Journal of Biomedical Informatics</em> 108: 103496. https://doi.org/<a href="https://doi.org/10.1016/j.jbi.2020.103496">https://doi.org/10.1016/j.jbi.2020.103496</a>.
</div>
<div id="ref-pmid32404155" class="csl-entry" role="listitem">
Ludwig, L., P. Darmon, and B Guerci. 2020. <span>“<span class="nocase">Computing and interpreting the Number Needed to Treat for Cardiovascular Outcomes Trials:Perspective on GLP-1 RA and SGLT-2i therapies</span>.”</span> <em>Cardiovasc Diabetol</em>, May. <a href="https://doi.org/10.1186/s12933-020-01034-3">https://doi.org/10.1186/s12933-020-01034-3</a>.
</div>
<div id="ref-doi:10.1177/0962280216669183" class="csl-entry" role="listitem">
Luo, Dehui, Xiang Wan, Jiming Liu, and Tiejun Tong. 2018. <span>“Optimally Estimating the Sample Mean from the Sample Size, Median, Mid-Range, and/or Mid-Quartile Range.”</span> <em>Statistical Methods in Medical Research</em> 27 (6): 1785–805. <a href="https://doi.org/10.1177/0962280216669183">https://doi.org/10.1177/0962280216669183</a>.
</div>
<div id="ref-pmid12614141" class="csl-entry" role="listitem">
Marx, Heiner C, Arthur. Bucher. 2003. <span>“Numbers Needed to Treat Derived from Meta-Analysis: A Word of Caution.”</span> <em>BMJ Evidence-Based Medicine</em> 8 (2): 36–37. <a href="https://doi.org/10.1136/ebm.8.2.36">https://doi.org/10.1136/ebm.8.2.36</a>.
</div>
<div id="ref-pmid29912013" class="csl-entry" role="listitem">
Mathur MB, Riddell CA, Ding P. 2018. <span>“Web Site and r Package for Computing e-Values.”</span> <em>Epidemiology</em>, e45–47. <a href="https://doi.org/10.1097/EDE.0000000000000864">https://doi.org/10.1097/EDE.0000000000000864</a>.
</div>
<div id="ref-pmid36412105" class="csl-entry" role="listitem">
McGrath, Sean, Stephan Katzenschlager, Alexander J. Zimmer, Alexander Seitel, Russell J. Steele, and Andrea Benedetti. 2022. <span>“Standard Error Estimation in Meta-Analysis of Studies Reporting Medians.”</span> <em>Statistical Methods in Medical Research</em> 32: 373–88. <a href="https://doi.org/10.1177/09622802221139233">https://doi.org/10.1177/09622802221139233</a>.
</div>
<div id="ref-doi:10.1177/0962280219889080" class="csl-entry" role="listitem">
McGrath, Sean, XiaoFei Zhao, Russell Steele, Brett D. Thombs, Andrea Benedetti, the DEPRESsion Screening Data (DEPRESSD) Collaboration, Brooke Levis, et al. 2020. <span>“Estimating the Sample Mean and Standard Deviation from Commonly Reported Quantiles in Meta-Analysis.”</span> <em>Statistical Methods in Medical Research</em> 29 (9): 2520–37. <a href="https://doi.org/10.1177/0962280219889080">https://doi.org/10.1177/0962280219889080</a>.
</div>
<div id="ref-pmid8210827" class="csl-entry" role="listitem">
Moses, L. E., D. Shapiro, and B. Littenberg. 1993. <span>“<span class="nocase"><span>C</span>ombining independent studies of a diagnostic test into a summary <span>R</span><span>O</span><span>C</span> curve: data-analytic approaches and some additional considerations</span>.”</span> <em>Stat Med</em> 12 (14): 1293–1316.
</div>
<div id="ref-pmid28579970" class="csl-entry" role="listitem">
Phan, T. G., B. B. Clissold, H. Ma, J. V. Ly, and V. Srikanth. 2017. <span>“<span class="nocase"><span>P</span>redicting <span>D</span>isability after <span>I</span>schemic <span>S</span>troke <span>B</span>ased on <span>C</span>omorbidity <span>I</span>ndex and <span>S</span>troke <span>S</span>everity-<span>F</span>rom the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.”</span> <em>Front Neurol</em> 8: 192.
</div>
<div id="ref-pmid26796056" class="csl-entry" role="listitem">
Phan, T. G., B. Clissold, J. Ly, H. Ma, C. Moran, V. Srikanth, K. R. Lees, et al. 2016. <span>“<span class="nocase"><span>S</span>troke <span>S</span>everity and <span>C</span>omorbidity <span>I</span>ndex for <span>P</span>rediction of <span>M</span>ortality after <span>I</span>schemic <span>S</span>troke from the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.”</span> <em>J Stroke Cerebrovasc Dis</em> 25 (4): 835–42.
</div>
<div id="ref-pmid16931782" class="csl-entry" role="listitem">
Phan, T. G., G. A. Donnan, S. M. Davis, and G. Byrnes. 2006. <span>“<span class="nocase"><span>P</span>roof-of-principle phase <span>I</span><span>I</span> <span>M</span><span>R</span><span>I</span> studies in stroke: sample size estimates from dichotomous and continuous data</span>.”</span> <em>Stroke</em> 37 (10): 2521–25.
</div>
<div id="ref-pmid16504541" class="csl-entry" role="listitem">
Phan, T. G., G. A. Donnan, M. Koga, L. A. Mitchell, M. Molan, G. Fitt, W. Chong, M. Holt, and D. C. Reutens. 2006. <span>“<span class="nocase"><span>T</span>he <span>A</span><span>S</span><span>P</span><span>E</span><span>C</span><span>T</span><span>S</span> template is weighted in favor of the striatocapsular region</span>.”</span> <em>Neuroimage</em> 31 (2): 477–81.
</div>
<div id="ref-pmid31272327" class="csl-entry" role="listitem">
Phan, T. G., N. Krishnadas, V. W. Y. Lai, M. Batt, L. A. Slater, R. V. Chandra, V. Srikanth, and H. Ma. 2019. <span>“<span class="nocase"><span>M</span>eta-<span>A</span>nalysis of <span>A</span>ccuracy of the <span>S</span>pot <span>S</span>ign for <span>P</span>redicting <span>H</span>ematoma <span>G</span>rowth and <span>C</span>linical <span>O</span>utcomes</span>.”</span> <em>Stroke</em> 50 (8): 2030–36.
</div>
<div id="ref-pmid16168343" class="csl-entry" role="listitem">
Reitsma, J. B., A. S. Glas, A. W. Rutjes, R. J. Scholten, P. M. Bossuyt, and A. H. Zwinderman. 2005. <span>“<span class="nocase"><span>B</span>ivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews</span>.”</span> <em>J Clin Epidemiol</em> 58 (10): 982–90.
</div>
<div id="ref-pmid26080338" class="csl-entry" role="listitem">
Salminen, P., H. Paajanen, T. Rautio, P. Nordstrom, M. Aarnio, T. Rantanen, R. Tuominen, et al. 2015. <span>“<span class="nocase"><span>A</span>ntibiotic <span>T</span>herapy vs <span>A</span>ppendectomy for <span>T</span>reatment of <span>U</span>ncomplicated <span>A</span>cute <span>A</span>ppendicitis: <span>T</span>he <span>A</span><span>P</span><span>P</span><span>A</span><span>C</span> <span>R</span>andomized <span>C</span>linical <span>T</span>rial</span>.”</span> <em>JAMA</em> 313 (23): 2340–48.
</div>
<div id="ref-pmid37161735" class="csl-entry" role="listitem">
Shi, Jiandong, Dehui Luo, Xiang Wan, Yue Liu, Jiming Liu, Zhaoxiang Bian, and Tiejun Tong. 2023. <span>“Detecting the Skewness of Data from the Five-Number Summary and Its Application in Meta-Analysis.”</span> <em>Statistical Methods in Medical Research</em> 32 (7): 1338–60. <a href="https://doi.org/10.1177/09622802231172043">https://doi.org/10.1177/09622802231172043</a>.
</div>
<div id="ref-doi10.1001/jamaneurol.2020.0678" class="csl-entry" role="listitem">
Signori, Alessio, Fabio Pellegrini, Francesca Bovis, Luca Carmisciano, Carl de Moor, and Maria Pia Sormani. 2020. <span>“<span class="nocase">Comparison of Placebos and Propensity Score Adjustment in Multiple Sclerosis Nonrandomized Studies</span>.”</span> <em>JAMA Neurology</em>, April. <a href="https://doi.org/10.1001/jamaneurol.2020.0678">https://doi.org/10.1001/jamaneurol.2020.0678</a>.
</div>
<div id="ref-pmid10356018" class="csl-entry" role="listitem">
Smeeth, A. Ebrahim, L. Haines. 1999. <span>“<span class="nocase">Numbers needed to treat derived from meta-analyses–sometimes informative, usually misleading</span>.”</span> <em>BMJ</em> 318: 1548–51. <a href="https://doi.org/10.1136/bmj.318.7197.1548">https://doi.org/10.1136/bmj.318.7197.1548</a>.
</div>
<div id="ref-pmid32167523" class="csl-entry" role="listitem">
Stensrud, M. J., and M. A. Hernan. 2020. <span>“<span class="nocase"><span>W</span>hy <span>T</span>est for <span>P</span>roportional <span>H</span>azards?</span>”</span> <em>JAMA</em>, March.
</div>
<div id="ref-pmid1143310" class="csl-entry" role="listitem">
TJ, Fagan. 1975. <span>“Nomogram for Bayes’s Theorem.”</span> <em>N Engl J Med</em> 293 (July): 257. <a href="https://doi.org/10.1056/NEJM197507312930513">https://doi.org/10.1056/NEJM197507312930513</a>.
</div>
<div id="ref-pmid28693043" class="csl-entry" role="listitem">
VanderWeele TJ, Ding P. 2017. <span>“Sensitivity Analysis in Observational Research: Introducing the e-Value.”</span> <em>Ann Intern Med</em> 167 (August): 268–74. <a href="https://doi.org/10.7326/M16-2607">https://doi.org/10.7326/M16-2607</a>.
</div>
<div id="ref-JSSv036i03" class="csl-entry" role="listitem">
Viechtbauer, Wolfgang. 2010. <span>“Conducting Meta-Analyses in r with the Metafor Package.”</span> <em>Journal of Statistical Software</em> 36 (3): 1–48. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-pmid25524443" class="csl-entry" role="listitem">
Wan, Wang, X. 2014. <span>“Estimating the Sample Mean and Standard Deviation from the Sample Size, Median, Range and/or Interquartile Range.”</span> <em>BMC Med Res Methodol</em>, December. https://doi.org/<a href="https://doi.org/10.1186/1471-2288-14-135">https://doi.org/10.1186/1471-2288-14-135</a>.
</div>
<div id="ref-doi:10.1056/NEJMsr077003" class="csl-entry" role="listitem">
Wang, Rui, Stephen W. Lagakos, James H. Ware, David J. Hunter, and Jeffrey M. Drazen. 2007. <span>“Statistics in Medicine — Reporting of Subgroup Analyses in Clinical Trials.”</span> <em>New England Journal of Medicine</em> 357 (21): 2189–94. <a href="https://doi.org/10.1056/NEJMsr077003">https://doi.org/10.1056/NEJMsr077003</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data-wrangling-python.html" class="pagination-link" aria-label="Python">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./multivariate.html" class="pagination-link" aria-label="Multivariate Analysis">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>